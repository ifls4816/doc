import{c as n}from"./app.b861fd15.js";import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";var a="/doc/assets/t333.76c1c11c.png",p="/doc/assets/t5.d3ca7cef.png",t="/doc/assets/t2.3ad2d94a.png",e="/doc/assets/ty.2603845d.png",o="/doc/assets/tt1.887023e1.png",c="/doc/assets/session.525b53ab.png",l="/doc/assets/middle.36d746a4.png";const u={},r=n(`<h1 id="nodejs" tabindex="-1"><a class="header-anchor" href="#nodejs" aria-hidden="true">#</a> Nodejs</h1><h2 id="_1-cmd-\u5E38\u7528\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#_1-cmd-\u5E38\u7528\u547D\u4EE4" aria-hidden="true">#</a> 1 cmd \u5E38\u7528\u547D\u4EE4</h2><ul><li>cd\uFF1A \u5207\u6362\u76EE\u5F55</li><li>dir\uFF1A\u67E5\u770B\u76EE\u5F55\u4E0B\u6240\u6709\u6587\u4EF6\u548C\u76EE\u5F55</li><li>cls\uFF1A\u6E05\u5C4F</li><li>exit\uFF1A\u9000\u51FA</li><li>cd .. \u8FD4\u56DE\u4E0A\u7EA7</li></ul><h2 id="_2-nodejs-\u7CFB\u7EDF\u6A21\u5757\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_2-nodejs-\u7CFB\u7EDF\u6A21\u5757\u64CD\u4F5C" aria-hidden="true">#</a> 2 Nodejs \u7CFB\u7EDF\u6A21\u5757\u64CD\u4F5C</h2><h3 id="_2-1-fs-readfile-\u6587\u4EF6\u8BFB\u53D6" tabindex="-1"><a class="header-anchor" href="#_2-1-fs-readfile-\u6587\u4EF6\u8BFB\u53D6" aria-hidden="true">#</a> 2.1 fs.readFile \u6587\u4EF6\u8BFB\u53D6</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u52A0\u8F7D(\u5BFC\u5165/\u5F15\u5165) fs \u6A21\u5757</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span> <span class="token comment">//require\u65B9\u6CD5\u662F node \u63D0\u4F9B\u7684\u5168\u5C40\u6210\u5458</span>

<span class="token comment">// \u8C03\u7528 readFile \u65B9\u6CD5\u8BFB\u53D6\u6587\u4EF6\u5185\u5BB9</span>
<span class="token doc-comment comment">/**
 * \u53C2\u65701: \u8981\u8BFB\u53D6\u7684\u6587\u4EF6\u8DEF\u5F84\uFF0C\u76F8\u5BF9\u8DEF\u5F84\u548C\u7EDD\u5BF9\u8DEF\u5F84\u5747\u53EF
 * \u53C2\u65702: \u5B57\u7B26\u96C6\u8BBE\u7F6E\uFF08\u53EF\u9009\uFF09 \u9ED8\u8BA4\u662F\u4E8C\u8FDB\u5236\u663E\u793A\uFF0C\u8BBE\u7F6E\u4E2D\u6587\u662Futf-8
 * \u53C2\u65703: \u6587\u4EF6\u8BFB\u53D6\u5B8C\u6210\u4E4B\u540E\u89E6\u53D1\u7684\u56DE\u8C03\u51FD\u6570\uFF0C\u6709\u4E24\u4E2A\u53C2\u6570  err \u548C data
 *    \u8BFB\u53D6\u6210\u529F\u65F6:  err\u5C31\u662F null\uFF0C data\u5C31\u662F\u6587\u4EF6\u4E2D\u7684\u5185\u5BB9
 *    \u8BFB\u53D6\u5931\u8D25\u65F6:  err\u662F\u9519\u8BEF\u5BF9\u8C61\uFF0C data\u662F undefined
 */</span>
fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">&#39;./files/a.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//\u5982\u679Cerr\u662F\u5BF9\u8C61\u65F6\uFF0C\u5C31\u4F1A\u88AB\u8BA4\u4E3A\u662F true</span>
  <span class="token comment">//err\u662Fnull\u65F6\uFF0C\u5C31\u4F1A\u88AB\u8BA4\u4E3A\u662F false</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u5F53err\u662F\u5BF9\u8C61\uFF08\u4FDD\u5B58\u4E86\u9519\u8BEF\u4FE1\u606F\uFF09\u65F6\uFF0C\u8FDB\u5165if</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u5F53err\u662Fnull\uFF08data\u4E2D\u5C31\u662F\u6587\u4EF6\u5185\u5BB9\uFF09\u65F6\uFF0C\u8FDB\u5165else</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_2-2-fs-writefile-\u6587\u4EF6\u5199\u5165" tabindex="-1"><a class="header-anchor" href="#_2-2-fs-writefile-\u6587\u4EF6\u5199\u5165" aria-hidden="true">#</a> 2.2 fs.writeFile \u6587\u4EF6\u5199\u5165</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
<span class="token comment">//\u7279\u70B9: \u8986\u76D6\u5199\u5165; \u5982\u679C\u6587\u4EF6\u4E0D\u5B58\u5728\u65F6\uFF0C\u4F1A\u5C1D\u8BD5\u521B\u5EFA\u3002</span>
<span class="token doc-comment comment">/**
 * \u53C2\u65701: \u8981\u5199\u7684\u6587\u4EF6\u8DEF\u5F84\uFF0C\u76F8\u5BF9\u8DEF\u5F84\u548C\u7EDD\u5BF9\u8DEF\u5F84\u5747\u53EF
 * \u53C2\u65702: \u8981\u5199\u5165\u5230\u6587\u4EF6\u7684\u5185\u5BB9\uFF08\u5B57\u7B26\u4E32\uFF09
 * \u53C2\u65703: \u53EF\u9009\u3002\u9ED8\u8BA4\u662F utf-8
 * \u53C2\u65704: \u5199\u5165\u5B8C\u6210\u65F6\u89E6\u53D1\u7684\u56DE\u8C03\u51FD\u6570\uFF0C\u6709\u4E00\u4E2A\u9519\u8BEF\u5BF9\u8C61 err
 */</span>
fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">&#39;./files/a.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;\u5468\u661F\u9A70: \u5E94\u8BE5\u662F\u70E4\u9E21\u7FC5\u8180\uFF0C\u6211\u6700\u7231\u5403&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//\u5199\u5165\u6B63\u786E\u65F6\uFF0Cerr\u5C31\u662F null</span>
  <span class="token comment">//\u5199\u5165\u5931\u8D25\u65F6\uFF0Cerr\u5C31\u662F \u9519\u8BEF\u5BF9\u8C61</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_2-3-fs-appendfile-\u6587\u4EF6\u8FFD\u52A0" tabindex="-1"><a class="header-anchor" href="#_2-3-fs-appendfile-\u6587\u4EF6\u8FFD\u52A0" aria-hidden="true">#</a> 2.3 fs.appendFile \u6587\u4EF6\u8FFD\u52A0</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//\u7279\u70B9: \u8FFD\u52A0\u5199\u5165\uFF1B\u5982\u679C\u6CA1\u6709\u8BE5\u6587\u4EF6\uFF0C\u5219\u5C1D\u8BD5\u521B\u5EFA</span>
<span class="token doc-comment comment">/**
 * \u53C2\u65701: \u6587\u4EF6\u8DEF\u5F84
 * \u53C2\u65702: \u8981\u5199\u5165\u7684\u5185\u5BB9
 * \u53C2\u65703: \u53EF\u9009\u3002\u5B57\u7B26\u96C6\uFF0C\u9ED8\u8BA4\u662F utf-8
 * \u53C2\u65704: \u5199\u5165\u5B8C\u6210\u65F6\u89E6\u53D1\u7684\u56DE\u8C03\u51FD\u6570\uFF0C\u6709\u4E00\u4E2A\u53C2\u6570 err
 */</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">appendFile</span><span class="token punctuation">(</span><span class="token string">&#39;./a.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;\u6211\u7231\u5E84\u5C0F\u66FC&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_3-node-\u521B\u5EFA-web-\u670D\u52A1\u5668" tabindex="-1"><a class="header-anchor" href="#_3-node-\u521B\u5EFA-web-\u670D\u52A1\u5668" aria-hidden="true">#</a> 3 Node \u521B\u5EFA Web \u670D\u52A1\u5668</h2><h3 id="_3-1-\u5B9E\u73B0\u4EE3\u7801" tabindex="-1"><a class="header-anchor" href="#_3-1-\u5B9E\u73B0\u4EE3\u7801" aria-hidden="true">#</a> 3.1 \u5B9E\u73B0\u4EE3\u7801</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//\u52A0\u8F7Dhttp\u6A21\u5757</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u521B\u5EFA\u670D\u52A1\u5668\u5BF9\u8C61</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// \u542F\u52A8\u670D\u52A1\u5668\uFF1A\u8BBE\u7F6E\u7AEF\u53E3\u4E3A3000\uFF0C\u542F\u52A8\u6210\u529F\u540E\u89E6\u53D1\u56DE\u8C03\u51FD\u6570\u5185\u5BB9</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u670D\u52A1\u5668\u6B63\u5728\u8FD0\u884C&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// \u5F00\u542F\u76D1\u542C\u6D4F\u89C8\u5668\u8BF7\u6C42\uFF1A</span>
<span class="token comment">// request\uFF08\u8BF7\u6C42\uFF09\uFF0C\u6307\u6D4F\u89C8\u5668\u53D1\u6765\u7684\u8BF7\u6C42</span>
<span class="token comment">// \u56DE\u8C03\u51FD\u6570\u7684\u53C2\u6570\uFF1A</span>
<span class="token comment">// req \u6D4F\u89C8\u5668\u7684\u8BF7\u6C42\u5BF9\u8C61</span>
<span class="token comment">// res \u670D\u52A1\u5668\u7684\u54CD\u5E94\u5BF9\u8C61</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;content-type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;text/html;charset=utf-8&#39;</span><span class="token punctuation">)</span>
  <span class="token comment">// .end()\u65B9\u6CD5\u662F\u5C06res\u7684\u5B57\u7B26\u4E32\u8FD4\u56DE\u7ED9\u6D41\u91CF\u5668</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;\u574F\u5973\u4EBA\u5E84\u5C0F\u66FC&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_3-2-req-\u4E2D\u7684-url-\u5C5E\u6027" tabindex="-1"><a class="header-anchor" href="#_3-2-req-\u4E2D\u7684-url-\u5C5E\u6027" aria-hidden="true">#</a> 3.2 req \u4E2D\u7684 URL \u5C5E\u6027</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u52A0\u8F7Dhttp\u6A21\u5757</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u521B\u5EFA\u670D\u52A1\u5668\u5BF9\u8C61</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// \u542F\u52A8\u670D\u52A1\u5668 \u5E76\u8BBE\u7F6E\u7AEF\u53E3\u4E3A3000 \u8BBE\u7F6E\u56DE\u8C03\u51FD\u6570\u8FD4\u56DE\u5185\u5BB9</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u670D\u52A1\u5668\u5F00\u59CB\u5DF2\u542F\u52A8&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// \u76D1\u542C\u6D4F\u89C8\u5668\u8BF7\u6C42\uFF0C\u5E76\u8FDB\u884C\u5904\u7406</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> req<span class="token punctuation">.</span>url <span class="token comment">//\u63A5\u6536req\u4E2D\u7684url\u5730\u5740 \u5B9A\u4E49\u4E3A\u65B0\u7684url</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;content-type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;text/html;charset=utf-8&#39;</span><span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&#39;/index.html&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;\u8FD9\u662F\u9996\u9875&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&#39;/list&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;\u8FD9\u662F\u5217\u8868\u9875&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;404 not found&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_3-3-\u4E2D\u6587\u4E71\u7801\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_3-3-\u4E2D\u6587\u4E71\u7801\u95EE\u9898" aria-hidden="true">#</a> 3.3 \u4E2D\u6587\u4E71\u7801\u95EE\u9898</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;content-type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;text/html;charset=utf-8&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="_3-4-\u9759\u6001\u8D44\u6E90\u52A0\u8F7D" tabindex="-1"><a class="header-anchor" href="#_3-4-\u9759\u6001\u8D44\u6E90\u52A0\u8F7D" aria-hidden="true">#</a> 3.4 \u9759\u6001\u8D44\u6E90\u52A0\u8F7D</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//\u5F15\u5165http\u6A21\u677F</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token comment">//\u521B\u5EFA\u670D\u52A1\u5668</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//\u5F00\u542F\u670D\u52A1\u5668  \u8BBE\u7F6E\u7AEF\u53E3\u4E3A3000 \u56DE\u8C03\u51FD\u6570\u8FD4\u56DE\u503C\u4E3Aserver is running</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;server is running&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//\u5F15\u5165fs\u6A21\u677F</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u5F00\u542F\u76D1\u542C\u6D4F\u89C8\u5668\u7684\u53D1\u9001\u503C</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//\u63A5\u6536req\u7684\u8DEF\u5F84</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> req<span class="token punctuation">.</span>url
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  <span class="token comment">//\u5224\u65AD:url\u8C03\u7528endsWith\u65B9\u6CD5\uFF0C\u5224\u65AD\u6D4F\u89C8\u5668\u53D1\u6765\u7684url\u662F\u5426\u662F\u4EE5.html\u7ED3\u5C3E</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&#39;.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u8BFB\u53D6\u670D\u52A1\u5668\u4E0A\u7684\u6587\u4EF6\uFF0C\u5E76\u8FD4\u56DE\u6570\u636E\u7ED9\u6D4F\u89C8\u5668</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">&#39;./public&#39;</span> <span class="token operator">+</span> url<span class="token punctuation">,</span> <span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//\u8BF7\u6C42\u8FC7\u540Ehtml\u9875\u9762\u4E0A\u8FD8\u4F1A\u6709\u94FE\u63A5 \u8FD8\u4F1A\u53D1\u9001\u8BF7\u6C42\uFF0C\u6240\u4EE5\u4F1A\u8D70\u591A\u6B21</span>
    <span class="token comment">// \u8FD9\u6B21\u662F\u5224\u65AD\u6D4F\u89C8\u5668\u53D1\u9001\u6765\u8BF7\u6C42\u7684\u8DEF\u5F84\u662F\u5426\u662F\u4EE5/public\u5F00\u5934\u7684</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&#39;/public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">&#39;.&#39;</span> <span class="token operator">+</span> url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        <span class="token comment">// console.log(data);</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;404 not found&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h2 id="_4-\u7EDD\u5BF9\u8DEF\u5F84" tabindex="-1"><a class="header-anchor" href="#_4-\u7EDD\u5BF9\u8DEF\u5F84" aria-hidden="true">#</a> 4 \u7EDD\u5BF9\u8DEF\u5F84</h2><h3 id="_4-1-\u7EDD\u5BF9\u8DEF\u5F84" tabindex="-1"><a class="header-anchor" href="#_4-1-\u7EDD\u5BF9\u8DEF\u5F84" aria-hidden="true">#</a> 4.1 \u7EDD\u5BF9\u8DEF\u5F84</h3><p>\u76F8\u5BF9\u8DEF\u5F84\u5728 node \u4E0B\u8FD0\u884C\u6709\u7F3A\u9677</p><h3 id="_4-2-\u8DEF\u5F84\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#_4-2-\u8DEF\u5F84\u53D8\u91CF" aria-hidden="true">#</a> 4.2 \u8DEF\u5F84\u53D8\u91CF</h3><ul><li>__dirname\uFF1A\u83B7\u53D6\u5F53\u524D\u6587\u4EF6\u6240\u5904\u76EE\u5F55\u7684\u7EDD\u5BF9\u8DEF\u5F84 \u4E0D\u5305\u542B\u6587\u4EF6\u540D</li><li>__filename\uFF1A\u83B7\u53D6\u5F53\u524D\u6587\u4EF6\u7684\u7EDD\u5BF9\u8DEF\u5F84 \u5305\u542B\u6587\u4EF6\u540D</li></ul><p>\u7279\u70B9\uFF1A \u8DE8\u5E73\u53F0\uFF0C \u81EA\u52A8\u5904\u7406\u8DEF\u5F84\u5206\u9694\u7B26 / \u548C \\</p><h3 id="_4-3-path-\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#_4-3-path-\u6A21\u5757" aria-hidden="true">#</a> 4.3 path \u6A21\u5757</h3><ul><li><ol><li>join \u65B9\u6CD5\uFF1A \u6784\u9020 url \u5730\u5740\uFF0C\u80FD\u591F\u6839\u636E\u4E0D\u540C\u53C2\u6570\u4E0D\u540C\u7CFB\u7EDF\u7EC4\u88C5\u4E0D\u540C\u7684\u6587\u4EF6\u5730\u5740</li></ol></li><li><ol start="2"><li>sep \u5C5E\u6027\uFF1A / \u6216 \\ \uFF0C windows \u7CFB\u7EDF\u4E0B\u662F \\ ; \u7C7B unix \u7CFB\u7EDF\u4E0B\u662F /</li></ol></li><li><ol start="3"><li>dirname(): \u83B7\u53D6\u6587\u4EF6\u8DEF\u5F84 \uFF08\u4E0D\u5305\u542B\u6587\u4EF6\u540D\uFF09</li></ol></li><li><ol start="4"><li>basename(): \u83B7\u53D6\u6587\u4EF6\u540D \uFF08\u4E0D\u5305\u542B\u76EE\u5F55\u8DEF\u5F84\uFF09</li></ol></li><li><ol start="5"><li>extname(): \u83B7\u53D6\u6587\u4EF6\u540E\u7F00 join \u65B9\u6CD5:</li></ol></li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>

path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;aaa&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;bbb&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ccc&#39;</span><span class="token punctuation">)</span> <span class="token comment">// windows: aaa\\bbb\\ccc    \u7C7Bunix\uFF1A aaa/bbb/ccc</span>
path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;d:/&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;node&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;test.js&#39;</span><span class="token punctuation">)</span> <span class="token comment">// d:\\node\\test.js</span>
path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;d:\\\\&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;node/test.js&#39;</span><span class="token punctuation">)</span> <span class="token comment">// d:\\node\\test.js</span>
path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span> <span class="token comment">// d:\\node\\day-2\\code\\view\\index.html</span>
path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view/list.html&#39;</span><span class="token punctuation">)</span> <span class="token comment">// d:\\node\\day-2\\code\\view\\list.html</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u5176\u4ED6\u65B9\u6CD5\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> fpath <span class="token operator">=</span> <span class="token string">&#39;D:/phpStudy/PHPTutorial/WWW/index.html&#39;</span>

path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>fpath<span class="token punctuation">)</span> <span class="token comment">// D:/phpStudy/PHPTutorial/WWW</span>
path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span>fpath<span class="token punctuation">)</span> <span class="token comment">// index.html</span>
path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span>fpath<span class="token punctuation">)</span> <span class="token comment">// .html</span>
path<span class="token punctuation">.</span>sep <span class="token comment">//  windows: \\     \u7C7Bunix\uFF1A /</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_4-4-http-\u521B\u5EFA\u670D\u52A1\u5668\u5BF9\u8FDB\u884C\u6587\u4EF6\u8BFB\u53D6" tabindex="-1"><a class="header-anchor" href="#_4-4-http-\u521B\u5EFA\u670D\u52A1\u5668\u5BF9\u8FDB\u884C\u6587\u4EF6\u8BFB\u53D6" aria-hidden="true">#</a> 4.4 http \u521B\u5EFA\u670D\u52A1\u5668\u5BF9\u8FDB\u884C\u6587\u4EF6\u8BFB\u53D6</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5B8C\u6574\u5C01\u88C5\u7684\u540E\u7AEF\u51FD\u6570</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;server-2 is runnig...&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function-variable function">sendAsk</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">fpath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>fpath<span class="token punctuation">,</span> <span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;404 not found.&#39;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> req<span class="token punctuation">.</span>url
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&#39;/index&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">sendAsk</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&#39;/post&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">sendAsk</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;post.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&#39;/public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">sendAsk</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&#39;/addpost&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u6B64\u5904\u662F\u8868\u5355\u63D0\u4EA4</span>
    <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;data&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      str <span class="token operator">+=</span> chunk
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;404 not found...&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="_5-\u7EFC\u5408\u6848\u4F8B" tabindex="-1"><a class="header-anchor" href="#_5-\u7EFC\u5408\u6848\u4F8B" aria-hidden="true">#</a> 5 \u7EFC\u5408\u6848\u4F8B</h2><p>\u4F7F\u7528\u6A21\u677F\u5F15\u64CE\u83B7\u53D6\u9875\u9762\u4E2D\u7684\u6570\u636E \u5B8C\u6574\u5B9E\u73B0\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5F15\u5165http\u6A21\u5757</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u521B\u5EFA\u670D\u52A1\u5668</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// \u5F00\u542F\u670D\u52A1\u5668 \u8BBE\u7F6E\u7AEF\u53E3\u4E3A3000</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;server is running&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//\u5F15\u5165fs\u6587\u4EF6\u6A21\u5757</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
<span class="token comment">//\u5F15\u5165\u8DEF\u5F84\u6A21\u5757</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u5F15\u5165\u7B2C\u4E09\u65B9\u6A21\u677F\u5F15\u64CE\u6A21\u5757</span>
<span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;art-template&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u76D1\u542C\u6D4F\u89C8\u5668\u8BF7\u6C42\uFF0C  req\u662F\u6D4F\u89C8\u5668\u8BF7\u6C42 res\u662F\u670D\u52A1\u5668\u54CD\u5E94</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u63A5\u6536\u6D4F\u89C8\u5668\u8BF7\u6C42\u7684\u8DEF\u5F84</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> req<span class="token punctuation">.</span>url
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&#39;/cate.html&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u83B7\u53D6\u7684obj\u5BF9\u8C61 \u8FD9\u53EF\u80FD\u662F\u5176\u4ED6\u6E20\u9053\u83B7\u53D6\u7684\u6570\u636E \u6B64\u5904\u53EA\u662F\u7B80\u5355\u7684\u6A21\u62DF</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token comment">//\u6CE8\u610F\u6B64\u5904\u7684list:      \u82E5\u4E0D\u52A0\u5728\u8FD9\u91CC\u7684\u8BDD\u53EF\u4EE5\u52A0\u5728\u4E0B\u9762\u5F15\u7528\u7684\u5730\u65B9</span>
          <span class="token literal-property property">cate_name</span><span class="token operator">:</span> <span class="token string">&#39;\u5947\u8DA3\u4E8B&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">cate_icon</span><span class="token operator">:</span> <span class="token string">&#39;fa-leaf&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">cate_ctime</span><span class="token operator">:</span> <span class="token string">&#39;2019-01-10&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">cate_name</span><span class="token operator">:</span> <span class="token string">&#39;\u6F6E\u79D1\u6280&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">cate_icon</span><span class="token operator">:</span> <span class="token string">&#39;fa-fire&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">cate_ctime</span><span class="token operator">:</span> <span class="token string">&#39;2019-01-10&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">cate_name</span><span class="token operator">:</span> <span class="token string">&#39;\u4F1A\u751F\u6D3B&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">cate_icon</span><span class="token operator">:</span> <span class="token string">&#39;fa-gift&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">cate_ctime</span><span class="token operator">:</span> <span class="token string">&#39;2019-01-15&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">cate_name</span><span class="token operator">:</span> <span class="token string">&#39;\u7F8E\u5947\u8FF9&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">cate_icon</span><span class="token operator">:</span> <span class="token string">&#39;fa-phone&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">cate_ctime</span><span class="token operator">:</span> <span class="token string">&#39;2019-01-16&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// \u8C03\u7528\u6A21\u677F\u5F15\u64CE   \u4E24\u4E2A\u53C2\u6570\uFF1A \u7B2C\u4E00\u4E2A\u662F\u8981\u66F4\u6539\u7684\u6587\u4EF6\u8DEF\u5F84  \u7B2C\u4E8C\u4E2A\u662F\u4F20\u5165\u7684\u5BF9\u8C61</span>
    <span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token function">template</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;cate.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span>
    <span class="token comment">// \u5C06\u62FC\u63A5\u597D\u7684str\u5B57\u7B26\u4E32\u4F20\u5165\u9875\u9762\u4E2D\u53BB  \u81F3\u6B64 \u6A21\u677F\u5F15\u64CE\u5E94\u7528\u5B8C\u6210</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&#39;/addcate.html&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;addcate.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;404 not found..&#39;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&#39;/assets&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;/view&#39;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;404 not found..&#39;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// \u6B64\u5904\u662F\u63D0\u4EA4\u8868\u5355\u5230  /addData\u76EE\u5F55\u4E2D\u53BB\uFF08\u4E0D\u8BBA\u8BE5\u76EE\u5F55\u662F\u5426\u5B58\u5728\uFF09</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&#39;/addData&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u5B9A\u4E49\u4E00\u4E2A\u7A7A\u5B57\u7B26\u4E32</span>
    <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
    <span class="token comment">// \u8BF7\u6C42\u5BF9\u8C61\u7684data\u4E8B\u4EF6,\u63A5\u6536\u8868\u5355\u4F20\u8FC7\u6765\u7684\u6570\u636E</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;data&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      str <span class="token operator">+=</span> chunk <span class="token comment">//\u62FC\u63A5\u5B57\u7B26\u4E32\u7684\u8FC7\u7A0B</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// \u5904\u7406\u6570\u636E  \u8BB0\u4F4F\u5C31\u884C</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br></div></div><h2 id="_6-art-template-\u6A21\u677F\u5F15\u64CE" tabindex="-1"><a class="header-anchor" href="#_6-art-template-\u6A21\u677F\u5F15\u64CE" aria-hidden="true">#</a> 6 art-template \u6A21\u677F\u5F15\u64CE</h2><h3 id="_6-1-\u540E\u7AEF\u4F7F\u7528-art-template-\u6A21\u677F\u5F15\u64CE" tabindex="-1"><a class="header-anchor" href="#_6-1-\u540E\u7AEF\u4F7F\u7528-art-template-\u6A21\u677F\u5F15\u64CE" aria-hidden="true">#</a> 6.1 \u540E\u7AEF\u4F7F\u7528 art-template \u6A21\u677F\u5F15\u64CE</h3><p>\u54C1\u4F18\u8D2D \u5B8C\u6574\u5B9E\u73B0\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;art-template&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;server is runnig...&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> req<span class="token punctuation">.</span>url
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&#39;/index&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> dataArr <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">goods_name</span><span class="token operator">:</span> <span class="token string">&#39;\u9633\u5149\u7F8E\u5305\u65B0\u6B3E\u5355\u80A9\u5305\u5973\u5305\u65F6\u5C1A\u5B50\u6BCD\u5305\u56DB\u4EF6\u5957\u5973&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">goods_price</span><span class="token operator">:</span> <span class="token string">&#39;116.00&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">goods_pic</span><span class="token operator">:</span> <span class="token string">&#39;uploads/like_01.png&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">goods_name</span><span class="token operator">:</span> <span class="token string">&#39;\u7231\u4ED5\u8FBE 30CM\u7092\u9505\u4E0D\u7C98\u9505NWG8330E\u7535\u78C1\u7089\u7092&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">goods_price</span><span class="token operator">:</span> <span class="token string">&#39;1161.00&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">goods_pic</span><span class="token operator">:</span> <span class="token string">&#39;uploads/like_02.png&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">goods_name</span><span class="token operator">:</span> <span class="token string">&#39;\u6377\u6CE2\u6717\u84DD\u7259\u8033\u673A&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">goods_price</span><span class="token operator">:</span> <span class="token string">&#39;116.00&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">goods_pic</span><span class="token operator">:</span> <span class="token string">&#39;uploads/like_03.png&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">goods_name</span><span class="token operator">:</span> <span class="token string">&#39;\u5927\u65B9\u5757\uFF0C\u4E0D\u77E5\u9053\u662F\u5E72\u4EC0\u4E48\u7528\u7684&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">goods_price</span><span class="token operator">:</span> <span class="token string">&#39;2116.00&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">goods_pic</span><span class="token operator">:</span> <span class="token string">&#39;uploads/like_04.png&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">goods_name</span><span class="token operator">:</span> <span class="token string">&#39;\u4E09\u661F\uFF08G5500\uFF09&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">goods_price</span><span class="token operator">:</span> <span class="token string">&#39;1816.00&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">goods_pic</span><span class="token operator">:</span> <span class="token string">&#39;uploads/like_05.png&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">goods_name</span><span class="token operator">:</span> <span class="token string">&#39;\u597D\u50CF\u662F\u4E2A\u6D17\u624B\u6DB2&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">goods_price</span><span class="token operator">:</span> <span class="token string">&#39;3116.00&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">goods_pic</span><span class="token operator">:</span> <span class="token string">&#39;uploads/like_06.png&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
    <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token function">template</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> dataArr<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&#39;/style&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&#39;/images&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&#39;/uploads&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;404 not found&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><h3 id="_6-2-\u6A21\u677F\u5F15\u64CE\u7684\u7EE7\u627F" tabindex="-1"><a class="header-anchor" href="#_6-2-\u6A21\u677F\u5F15\u64CE\u7684\u7EE7\u627F" aria-hidden="true">#</a> 6.2 \u6A21\u677F\u5F15\u64CE\u7684\u7EE7\u627F</h3><p>\u540E\u7AEF\u4F7F\u7528 template \u7EE7\u627F</p><blockquote><p>\u6CE8\u610F\uFF1A \u4F7F\u7528 template \u7EE7\u627F\u9700\u8981\u5728 node \u670D\u52A1\u5668\u52A0\u8F7D template \u6A21\u5757\uFF0C\u5E76\u4E14\u76D1\u542C\u5230\u8DEF\u7531\u540E\u8FD4\u56DE\u7684\u9875\u9762\u5FC5\u987B\u7528 res.render \u65B9\u6CD5</p></blockquote><p>\u5236\u4F5C\u6A21\u677F\u9875\uFF1A</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>zh-CN<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Dashboard <span class="token entity named-entity" title="\xAB">&amp;laquo;</span> Admin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/assets/vendors/bootstrap/css/bootstrap.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/assets/vendors/font-awesome/css/font-awesome.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/assets/vendors/nprogress/nprogress.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/assets/css/admin.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/assets/vendors/nprogress/nprogress.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/assets/vendors/art-template/template-web.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    {{block &#39;css&#39;}} {{/block}}
    <span class="token comment">&lt;!--\u4E3A\u4E86\u7ED9\u8981\u52A0\u5165\u7684css\u7559\u4F4D\u7F6E--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      NProgress<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>navbar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-default navbar-btn fa fa-bars<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nav navbar-nav navbar-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>profile.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-user<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>\u4E2A\u4EBA\u4E2D\u5FC3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>login.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-sign-out<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>\u9000\u51FA<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span>
      {{block &#39;body&#39;}} {{/block}}
      <span class="token comment">&lt;!--\u6B64\u5904\u6DFB\u52A0\u9700\u8981\u52A0\u5165\u7684\u6A21\u5757--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>aside<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>profile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>avatar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/uploads/avatar.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u5E03\u5934\u513F<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nav<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/admin/index.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-dashboard<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>\u4EEA\u8868\u76D8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>active<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#menu-posts<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-toggle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>collapse<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-thumb-tack<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>\u6587\u7AE0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-angle-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>menu-posts<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>collapse in<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/admin/post/posts.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u6240\u6709\u6587\u7AE0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/admin/post/addpost.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u5199\u6587\u7AE0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>active<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/admin/cate/cate.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u5206\u7C7B\u76EE\u5F55<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/admin/comment/comments.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-comments<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>\u8BC4\u8BBA<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/admin/user/users.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-users<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>\u7528\u6237<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#menu-settings<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>collapsed<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-toggle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>collapse<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-cogs<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>\u8BBE\u7F6E<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-angle-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>menu-settings<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>collapse<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/admin/other/nav-menus.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u5BFC\u822A\u83DC\u5355<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/admin/other/slides.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u56FE\u7247\u8F6E\u64AD<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/admin/other/settings.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u7F51\u7AD9\u8BBE\u7F6E<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/assets/vendors/jquery/jquery.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/assets/vendors/bootstrap/js/bootstrap.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      NProgress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    {{block &#39;js&#39;}} {{/block}}
    <span class="token comment">&lt;!--\u6B64\u5904\u4E3A\u4E86\u7ED9\u540E\u52A0\u5165\u7684js\u6A21\u5757\u7559\u4F4D\u7F6E--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br></div></div><p>\u5E94\u7528\u9875\u8C03\u7528\uFF1A</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>{{extend &#39;./layouts/layout.html&#39;}}
<span class="token comment">&lt;!--\u8C03\u7528\u6A21\u677F\u9875--&gt;</span>

{{block &#39;css&#39;}}
<span class="token comment">&lt;!--\u5BF9\u5E94\u7684\u4F4D\u7F6E\u5199\u51FACSS--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">body</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
{{/block}} {{block &#39;body&#39;}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container-fluid<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jumbotron text-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>One Belt, One Road<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Thoughts, stories and ideas.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-primary btn-lg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post-add.html<span class="token punctuation">&quot;</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u5199\u6587\u7AE0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panel panel-default<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panel-heading<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panel-title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u7AD9\u70B9\u5185\u5BB9\u7EDF\u8BA1\uFF1A<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list-group-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span>10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span>\u7BC7\u6587\u7AE0\uFF08<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span>\u7BC7\u8349\u7A3F\uFF09<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list-group-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span>6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span>\u4E2A\u5206\u7C7B<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list-group-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span>\u6761\u8BC4\u8BBA\uFF08<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span>\u6761\u5F85\u5BA1\u6838\uFF09<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
{{/block}} {{block &#39;js&#39;}} {{/block}}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h2 id="_7-post-\u65B9\u5F0F\u63D0\u4EA4\u8868\u5355\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_7-post-\u65B9\u5F0F\u63D0\u4EA4\u8868\u5355\u6570\u636E" aria-hidden="true">#</a> 7 post \u65B9\u5F0F\u63D0\u4EA4\u8868\u5355\u6570\u636E</h2><h3 id="_7-1-\u8868\u5355\u63D0\u4EA4\u7684\u5FC5\u8981\u6761\u4EF6" tabindex="-1"><a class="header-anchor" href="#_7-1-\u8868\u5355\u63D0\u4EA4\u7684\u5FC5\u8981\u6761\u4EF6" aria-hidden="true">#</a> 7.1 \u8868\u5355\u63D0\u4EA4\u7684\u5FC5\u8981\u6761\u4EF6</h3><ul><li>\u5FC5\u987B\u6709 form \u6807\u7B7E <ul><li>action\uFF1A\u8868\u5355\u6570\u636E\u63D0\u4EA4\u7684\u4F4D\u7F6E\uFF0C\u5FC5\u987B\u662F\u4E00\u79CD\u540E\u7AEF\u6280\u672F\u6765\u63A5\u6536</li><li>method\uFF1A \u8868\u5355\u63D0\u4EA4\u7684\u65B9\u5F0F\uFF0Cpost\uFF08\u5E38\u7528\uFF09\u3001 get\uFF08\u9ED8\u8BA4\uFF09</li><li>\u6BCF\u4E2A\u8868\u5355\u57DF\u90FD\u8981\u6709 name \u5C5E\u6027\u548C value \u503C</li><li>\u5FC5\u987B\u8981\u6709 submit \u6309\u94AE</li></ul></li></ul><h3 id="_7-2-\u4E0D\u540C\u8868\u5355\u63D0\u4EA4\u7684\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#_7-2-\u4E0D\u540C\u8868\u5355\u63D0\u4EA4\u7684\u65B9\u5F0F" aria-hidden="true">#</a> 7.2 \u4E0D\u540C\u8868\u5355\u63D0\u4EA4\u7684\u65B9\u5F0F</h3><p>\u8868\u5355\u63D0\u4EA4\u5C31\u662F\u63D0\u4EA4\u5176 value \u503C</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>name:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> password:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>psd<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token comment">&lt;!-- \u7701\u7565\u5176\u4F59Input\u6807\u7B7E \u90FD\u662F\u63D0\u4EA4\u8D77value\u503C --&gt;</span>
<span class="token comment">&lt;!-- radio checkbox\u4E0D\u8BBE\u7F6Evalue\u503C\u65F6\u4F1A\u81EA\u52A8\u63D0\u4EA4\u6210on --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>area<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>add<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- select\u63D0\u4EA4 value\u503C\u5199\u5728option\u4E0B \u82E5option\u6CA1\u6709value \u5219\u4F1A\u63D0\u4EA4option\u95F4\u7684\u5185\u5BB9--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bj<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u5317\u4EAC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sh<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u4E0A\u6D77<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sz<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u6DF1\u5733<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>gz<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u5E7F\u5DDE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sign<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>111<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cols</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>30<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u8FD9\u5BB6\u4F19\u5F88\u61D2\uFF0C\u4EC0\u4E48\u4E5F\u6CA1\u7559\u4E0B<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- textarea\u4E0D\u7528\u5199value \u76F4\u63A5\u63D0\u4EA4\u5C31\u53EF\u4EE5 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_7-3-post-\u65B9\u5F0F\u63A5\u6536" tabindex="-1"><a class="header-anchor" href="#_7-3-post-\u65B9\u5F0F\u63A5\u6536" aria-hidden="true">#</a> 7.3 POST \u65B9\u5F0F\u63A5\u6536</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&#39;&#39;</span> <span class="token comment">//\u5B9A\u4E49\u4E00\u4E2A\u7A7A\u5B57\u7B26\u4E32 \u7528\u4E8E\u63A5\u6536data\u4E8B\u4EF6\u7684\u503C</span>

<span class="token comment">//1. \u76D1\u542Cdata\u4E8B\u4EF6\uFF0C\u5FAA\u73AF\u63A5\u6536post\u8868\u5355\u63D0\u4EA4\u7684\u6570\u636E</span>
<span class="token comment">//\u53C2\u65701\uFF1A \u4E8B\u4EF6\u7C7B\u578B\uFF0Cdata\u4EE3\u8868\u63A5\u6536\u5BA2\u6237\u7AEF\u6570\u636E\u4E8B\u4EF6</span>
<span class="token comment">//\u53C2\u65702\uFF1A \u63A5\u6536\u65F6\u89E6\u53D1\u7684\u56DE\u8C03\u51FD\u6570</span>
<span class="token comment">// \u4F7F\u7528post\u63D0\u4EA4\u7684\u8868\u5355\u6570\u636E\u53EF\u80FD\u4F1A\u975E\u5E38\u5927\uFF0C\u9700\u8981\u5207\u5272\u6210\u4E00\u4E2A\u4E2A\u7684\u5C0F\u6570\u636E\u5757\u8FDB\u884C\u63A5\u6536</span>
req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;data&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  str <span class="token operator">+=</span> chunk
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//2. \u76D1\u542Cend\u4E8B\u4EF6\uFF0C\u63A5\u6536\u5B8C\u6210\u540E\u5904\u7406\u63A5\u6536\u5230\u6570\u636E\u7684\u4E8B\u4EF6</span>
<span class="token comment">//\u53C2\u65701\uFF1A \u4E8B\u4EF6\u7C7B\u578B\uFF0Cend\u4EE3\u8868\u63A5\u6536\u6570\u636E\u5B8C\u6210\u65F6\u89E6\u53D1\u7684\u56DE\u8C03\u51FD\u6570</span>
<span class="token comment">//\u53C2\u65702\uFF1A \u5B8C\u6210\u540E\u89E6\u53D1\u7684\u56DE\u8C03\u51FD\u6570\uFF0C\u5728\u8BE5\u51FD\u6570\u4E2D\u53EF\u4EE5\u5904\u7406\u63A5\u6536\u5230\u7684\u6570\u636E</span>
req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
  eq<span class="token punctuation">.</span>body <span class="token operator">=</span> str <span class="token comment">//\u6CE8\u610F\uFF1A\u7528body-parser\u6A21\u5757\u4E2D req.body.xxx \u5C31\u662F\u6839\u636E\u6B64\u5904\u5C01\u88C5\u800C\u6210\u7684</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A\u770B\u4E0A\u9762</p><h3 id="_7-4-get-\u65B9\u5F0F\u63A5\u6536" tabindex="-1"><a class="header-anchor" href="#_7-4-get-\u65B9\u5F0F\u63A5\u6536" aria-hidden="true">#</a> 7.4 GET \u65B9\u5F0F\u63A5\u6536</h3><ul><li><p>url \u6A21\u5757\uFF1A\u4F7F\u7528\u7CFB\u7EDF\u7684 url \u6A21\u5757\u5B9E\u73B0\u8868\u5355\u63D0\u4EA4</p></li><li><p>url \u4E2D\u7684\u4E24\u4E2A\u91CD\u8981\u65B9\u6CD5\uFF1A \uFF08/post?name=zs&amp;age=18\uFF09</p><ul><li>pathname: \u5F53\u524D\u8BF7\u6C42\u7684 url \u5730\u5740 /post</li><li>query: get \u65B9\u5F0F\u63D0\u4EA4\u7684\u53C2\u6570 name=zs&amp;age=18</li></ul></li></ul><p>\u7B80\u5355\u793A\u4F8B\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u52A0\u8F7D\u7CFB\u7EDF\u4E2D\u81EA\u5E26\u7684url\u6A21\u5757</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;url&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u8C03\u7528\u6A21\u5757\u4E2D\u7684parse()\u65B9\u6CD5  \u7528\u4E8E\u89E3\u6790get\u5730\u5740</span>
<span class="token comment">// parse\u7684\u4E24\u4E2A\u53C2\u6570\uFF1A 1\uFF1A\u8981\u89E3\u6790\u7684\u5730\u5740 2\u662F\u5426\u81EA\u52A8\u8F6C\u6362\u4E3A\u5BF9\u8C61\u683C\u5F0F\u8F93\u51FA  false\u4E3A\u5B57\u7B26\u4E32    \u8FD4\u56DE\u503C\u4E2D\u6709\u4E24\u4E2A\u8981\u8BB0\u4F4F</span>
<span class="token comment">// \u5206\u522B\u662F\uFF1Apathname (\u89E3\u6790\u51FA\u6765\u7684\u5730\u5740/getData)  query(\u4EE5\u5BF9\u8C61\u5F62\u5F0F\u4FDD\u5B58\u4E86get\u7684\u53C2\u6570)\uFF1A{username:&#39;xm&#39;,psd=&#39;123456}</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&#39;http://127.0.0.1:3000/getData?username=xm&amp;psd=123456&#39;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>\u8868\u5355\u4F7F\u7528 get \u65B9\u5F0F\u63D0\u4EA4\u6570\u636E\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u52A0\u8F7Durl\u7CFB\u7EDF\u6A21\u5757</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;url&#39;</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;server is runnig...&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u4F7F\u7528url\u4E2D\u7684parse\u65B9\u6CD5\uFF0C\u628Areq.url\u8BF7\u6C42\u5BF9\u8C61\u7684\u5730\u5740\u8F6C\u6362\u4E3A\u5BF9\u8C61\u7684\u65B9\u5F0F</span>
  <span class="token keyword">const</span> urlObj <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token comment">// \u8C03\u7528parse\u8F6C\u51FA\u6765\u7684urlObjc\u5BF9\u8C61\u4E2D\u7684pathname\u65B9\u6CD5</span>
  <span class="token comment">// pathname\u65B9\u6CD5\u8868\u793A\u5F53\u524D\u670D\u52A1\u5668\u8BF7\u6C42\u7684url\u5730\u5740\u540D</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>urlObj<span class="token punctuation">.</span>pathname <span class="token operator">===</span> <span class="token string">&#39;/index&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>urlObj<span class="token punctuation">.</span>pathname <span class="token operator">===</span> <span class="token string">&#39;/getData&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u8C03\u7528parse\u8F6C\u51FA\u6765\u7684urlObjc\u5BF9\u8C61\u4E2D\u7684query\u65B9\u6CD5</span>
    <span class="token comment">// query\u65B9\u6CD5\u4EE3\u8868get\u4F20\u8F93\u4E2D\u6240\u63D0\u4EA4\u7684\u53C2\u6570</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>urlObj<span class="token punctuation">.</span>query<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;data has been upload&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;404&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="_7-5-post-\u548C-get-\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#_7-5-post-\u548C-get-\u533A\u522B" aria-hidden="true">#</a> 7.5 POST \u548C GET \u533A\u522B</h3><ul><li><p>\u63D0\u4EA4\u65B9\u5F0F\u4E0D\u540C\uFF1Aget \u4F1A\u5C06\u63D0\u4EA4\u6570\u636E\u663E\u793A\u5728\u5730\u5740\u680F\u4E2D post \u4E0D\u4F1A</p></li><li><p>\u4F20\u9012\u6570\u636E\u7684\u5927\u5C0F\u6709\u5DEE\u5F02\uFF1Aget \u53D7\u5730\u5740\u680F\u5F71\u54CD\u53EA\u80FD\u4F20 2k(ie6)\u6216\u8005 8k(chrome),post \u6700\u5C0F\u503C 2m \u6CA1\u6709\u4E0A\u9650</p></li><li><p>\u5E94\u7528\u8303\u56F4\u4E0D\u540C\uFF1Aget \u4F7F\u7528\u8303\u56F4\u8F83\u5E7F\uFF0C\u94FE\u63A5\u8DF3\u8F6C \u4F20\u9012\u6570\u636E location.href \u4E2D\u90FD\u80FD\u4F7F\u7528,post \u591A\u7528\u4E8E\u8868\u5355\u63D0\u4EA4</p></li></ul><h2 id="_8-path-\u4E2D\u7684-parse-\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_8-path-\u4E2D\u7684-parse-\u65B9\u6CD5" aria-hidden="true">#</a> 8 path \u4E2D\u7684 parse()\u65B9\u6CD5</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//1. \u52A0\u8F7D url \u6A21\u5757</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;url&#39;</span><span class="token punctuation">)</span>

<span class="token comment">//2. \u5728url\u6A21\u5757\u4E2D\u63D0\u4F9B\u4E86\u4E00\u4E2A parse \u7684\u65B9\u6CD5</span>
<span class="token comment">//\u8BE5\u65B9\u6CD5\u53EF\u4EE5\u89E3\u6790 /getData?username=xm&amp;userpwd=123456 url\u5730\u5740</span>

<span class="token comment">// let str = &#39;http://127.0.0.1:3000/getData?username=xm&amp;userpwd=123456&#39;;</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&#39;/index&#39;</span>

<span class="token doc-comment comment">/**
 * parse: \u89E3\u6790url\u5730\u5740
 * \u53C2\u65701: \u8981\u89E3\u6790\u7684\u5730\u5740
 * \u53C2\u65702: true (get\u53C2\u6570\u4F1A\u81EA\u52A8\u8F6C\u4E3A\u5BF9\u8C61) / false (get\u53C2\u6570\u5C31\u662F\u4E00\u4E2A\u5B57\u7B26\u4E32)
 * \u8FD4\u56DE\u503C\u4E2D\u6709\u4E24\u4E2A\u5C5E\u6027\u5FC5\u987B\u8BB0\u4F4F: pathname \u3001 query
 *    pathname: \u662F\u5730\u5740
 *    query: \u4FDD\u5B58\u4E86get\u53C2\u6570
 */</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">//  username=xm&amp;userpwd=123456</span>
<span class="token comment">//  1. \u4F7F\u7528 &amp; \u5C06\u5B57\u7B26\u4E32\u62C6\u5206\u4E3A\u6570\u7EC4  [&#39;username=xm&#39;, &#39;userpwd=123456&#39;];</span>
<span class="token comment">//  2. \u518D\u4F7F\u7528 = \u5C06\u6BCF\u4E2A\u5355\u5143\u7684\u5B57\u7B26\u4E32\u90FD\u8FDB\u884C\u62C6\u5206  username\u3001xm | userpwd\u3001123456</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>##9 \u5B57\u4F53\u56FE\u6807\u95EE\u9898\u7684\u89E3\u51B3</p><p>\u4F7F\u7528 url \u6A21\u5757\u53EF\u4EE5\u89E3\u51B3\u8BE5\u95EE\u9898</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;url&#39;</span><span class="token punctuation">)</span>

<span class="token comment">//2. \u5728url\u6A21\u5757\u4E2D\u63D0\u4F9B\u4E86\u4E00\u4E2A parse \u7684\u65B9\u6CD5</span>
<span class="token comment">//\u8BE5\u65B9\u6CD5\u53EF\u4EE5\u89E3\u6790 /getData?username=xm&amp;userpwd=123456 url\u5730\u5740</span>

<span class="token comment">// let str = &#39;http://127.0.0.1:3000/getData?username=xm&amp;userpwd=123456&#39;;</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&#39;/index&#39;</span>

<span class="token doc-comment comment">/**
 * parse: \u89E3\u6790url\u5730\u5740
 * \u53C2\u65701: \u8981\u89E3\u6790\u7684\u5730\u5740
 * \u53C2\u65702: true (get\u53C2\u6570\u4F1A\u81EA\u52A8\u8F6C\u4E3A\u5BF9\u8C61) / false (get\u53C2\u6570\u5C31\u662F\u4E00\u4E2A\u5B57\u7B26\u4E32)
 * \u8FD4\u56DE\u503C\u4E2D\u6709\u4E24\u4E2A\u5C5E\u6027\u5FC5\u987B\u8BB0\u4F4F: pathname \u3001 query
 *    pathname: \u662F\u5730\u5740
 *    query: \u4FDD\u5B58\u4E86get\u53C2\u6570
 */</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">//  username=xm&amp;userpwd=123456</span>
<span class="token comment">//  1. \u4F7F\u7528 &amp; \u5C06\u5B57\u7B26\u4E32\u62C6\u5206\u4E3A\u6570\u7EC4  [&#39;username=xm&#39;, &#39;userpwd=123456&#39;];</span>
<span class="token comment">//  2. \u518D\u4F7F\u7528 = \u5C06\u6BCF\u4E2A\u5355\u5143\u7684\u5B57\u7B26\u4E32\u90FD\u8FDB\u884C\u62C6\u5206  username\u3001xm | userpwd\u3001123456</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;server is running&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;art-template&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u5F15\u5165url\u6A21\u5757</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;url&#39;</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// const url = req.url;</span>
  <span class="token keyword">const</span> urlObj <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>urlObj<span class="token punctuation">.</span>pathname <span class="token operator">===</span> <span class="token string">&#39;/cate&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//urlObj.pathname\u662F\u670D\u52A1\u5668\u8BF7\u6C42\u7684\u8DEF\u5F84</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">cate_name</span><span class="token operator">:</span> <span class="token string">&#39;\u5947\u8DA3\u4E8B&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">cate_icon</span><span class="token operator">:</span> <span class="token string">&#39;fa-leaf&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">cate_ctime</span><span class="token operator">:</span> <span class="token string">&#39;2019-01-10&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">cate_name</span><span class="token operator">:</span> <span class="token string">&#39;\u6F6E\u79D1\u6280&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">cate_icon</span><span class="token operator">:</span> <span class="token string">&#39;fa-fire&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">cate_ctime</span><span class="token operator">:</span> <span class="token string">&#39;2019-01-10&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token function">template</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;cate.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>urlObj<span class="token punctuation">.</span>pathname <span class="token operator">===</span> <span class="token string">&#39;/addcate&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//urlObj.pathname\u662F\u670D\u52A1\u5668\u8BF7\u6C42\u7684\u8DEF\u5F84</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;addcate.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// console.log(err);</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;404 not found..&#39;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>urlObj<span class="token punctuation">.</span>pathname<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&#39;/assets&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//urlObj.pathname\u662F\u670D\u52A1\u5668\u8BF7\u6C42\u7684\u8DEF\u5F84</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;/view&#39;</span><span class="token punctuation">,</span> urlObj<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">//\u6CE8\u610F\u6B64\u5904\u66F4\u6539\u539F\u6709\u7684url\uFF0C\u5426\u5219\u62A5\u9519</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;404 not found..&#39;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>urlObj<span class="token punctuation">.</span>pathname <span class="token operator">===</span> <span class="token string">&#39;/addData&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//urlObj.pathname\u662F\u670D\u52A1\u5668\u8BF7\u6C42\u7684\u8DEF\u5F84</span>
    <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;data&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      str <span class="token operator">+=</span> chunk
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;404&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><h2 id="_9-http-\u534F\u8BAE" tabindex="-1"><a class="header-anchor" href="#_9-http-\u534F\u8BAE" aria-hidden="true">#</a> 9 http \u534F\u8BAE</h2><h3 id="_9-1-http-\u534F\u8BAE\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#_9-1-http-\u534F\u8BAE\u6982\u8FF0" aria-hidden="true">#</a> 9.1 http \u534F\u8BAE\u6982\u8FF0</h3><ul><li><p>\u534F\u8BAE\u7684\u4E24\u5927\u90E8\u5206\uFF1A</p><ul><li>\u8BF7\u6C42\uFF1A\u8BBF\u95EE\u670D\u52A1\u5668\u7684\u4EFB\u4F55\u4E00\u4E2A\u6587\u4EF6\u90FD\u662F\u4E00\u6B21\u8BF7\u6C42</li><li>\u54CD\u5E94\uFF1A\u670D\u52A1\u5668\u5904\u7406\u8BF7\u6C42\uFF0C\u5C06\u7ED3\u679C\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668</li></ul></li><li><p>\u7279\u70B9\uFF1A</p><ul><li>\u901A\u5E38\u662F\u57FA\u4E8E B/S \u7ED3\u6784\u8F6F\u4EF6\u7684</li><li>\u65E0\u8FDE\u63A5: \u6D4F\u89C8\u5668\u5411\u670D\u52A1\u5668\u53D1\u9001\u4E00\u6B21\u8BF7\u6C42\uFF0C\u670D\u52A1\u5668\u54CD\u5E94\u4E00\u6B21\uFF0C\u94FE\u63A5\u5373\u7ED3\u675F</li><li>\u65E0\u72B6\u6001: \u65E0\u8BB0\u5FC6\u3002 \u670D\u52A1\u5668\u4E0D\u80FD\u8BB0\u4F4F\u54EA\u4E2A\u6D4F\u89C8\u5668\u8BBF\u95EE\u8FC7</li></ul></li></ul><h3 id="_9-2-\u8BF7\u6C42\u534F\u8BAE-\u8BF7\u6C42\u62A5\u6587" tabindex="-1"><a class="header-anchor" href="#_9-2-\u8BF7\u6C42\u534F\u8BAE-\u8BF7\u6C42\u62A5\u6587" aria-hidden="true">#</a> 9.2 \u8BF7\u6C42\u534F\u8BAE/\u8BF7\u6C42\u62A5\u6587</h3><ul><li><p>\u8BF7\u6C42\u884C: \u8BF7\u6C42\u65B9\u5F0F\u3001\u8BF7\u6C42 URL \u5730\u5740\u3001\u534F\u8BAE\u7248\u672C\u53F7</p></li><li><p>\u8BF7\u6C42\u5934: \u4E3B\u673A\u57DF\u540D\u548C\u7AEF\u53E3\u53F7\uFF0C\u5BA2\u6237\u7AEF(\u6D4F\u89C8\u5668)\u7684\u4FE1\u606F\u7B49</p></li><li><p>\u8BF7\u6C42\u4E3B\u4F53: \u53D1\u9001\u7ED9\u670D\u52A1\u5668\u7684\u6570\u636E\uFF0Cget \u548C post \u90FD\u4F1A\u901A\u8FC7\u8BF7\u6C42\u4E3B\u4F53\u5C06\u6570\u636E\u53D1\u9001\u7ED9\u670D\u52A1\u5668</p></li><li><p>\u4E3B\u8981\u8BF7\u6C42\u9879\u610F\u601D:</p><ul><li>host\uFF1A \u4E3B\u673A\u540D\u548C\u7AEF\u53E3\u53F7\uFF0C80 \u7AEF\u53E3\u9ED8\u8BA4\u4E0D\u663E\u793A</li><li>accept\uFF1A\u6D4F\u89C8\u5668\u53EF\u63A5\u53D7\u7684\u7A0B\u5E8F/\u6587\u4EF6\u7C7B\u578B</li><li>accept-encoding\uFF1A \u6D4F\u89C8\u5668\u53EF\u63A5\u53D7\u7684\u538B\u7F29\u7C7B\u578B</li><li>accept-language\uFF1A \u6D4F\u89C8\u5668\u53EF\u63A5\u53D7\u7684\u8BED\u8A00\u7C7B\u578B</li><li>content-type\uFF1A \u6D4F\u89C8\u5668\u5411\u670D\u52A1\u5668\u53D1\u9001\u6570\u636E\u65F6\u7684\u7F16\u7801\u65B9\u5F0F</li></ul></li></ul><p>\u8BF7\u6C42\u884C\u548C\u8BF7\u6C42\u5934\uFF1A <img src="`+a+'" alt="123"> GET \u65B9\u5F0F\u63D0\u4EA4\u7684\u8BF7\u6C42\u884C\u3001\u8BF7\u6C42\u5934\u548C\u8BF7\u6C42\u4F53: <img src="'+p+'" alt="123"> POST \u65B9\u5F0F\u63D0\u4EA4\u6570\u636E\uFF0C\u67E5\u770B\u8BF7\u6C42\u884C\u3001\u8BF7\u6C42\u5934\u548C\u8BF7\u6C42\u4F53 <img src="'+t+'" alt="123"></p><h3 id="_9-3-\u54CD\u5E94\u534F\u8BAE-\u54CD\u5E94\u62A5\u6587" tabindex="-1"><a class="header-anchor" href="#_9-3-\u54CD\u5E94\u534F\u8BAE-\u54CD\u5E94\u62A5\u6587" aria-hidden="true">#</a> 9.3 \u54CD\u5E94\u534F\u8BAE/\u54CD\u5E94\u62A5\u6587</h3><ul><li><p>\u54CD\u5E94\u884C: \u534F\u8BAE\u7248\u672C\u53F7\u3001\u54CD\u5E94\u7ED3\u679C\u72B6\u6001\u7801</p></li><li><p>\u54CD\u5E94\u5934: \u4E3B\u8981\u662F\u670D\u52A1\u5668\u7AEF\u7684\u4FE1\u606F</p></li><li><p>\u54CD\u5E94\u4E3B\u4F53: \u5C31\u662F\u4ECE\u670D\u52A1\u5668\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\u7684\u6570\u636E</p></li><li><p>\u4E3B\u8981\u8BF7\u6C42\u9879\u610F\u601D:</p><ul><li>content-type\uFF1A \u54CD\u5E94\u5185\u5BB9\u7C7B\u578B\uFF0C content-type:text/html\uFF0C\u670D\u52A1\u5668\u544A\u8BC9\u6D4F\u89C8\u5668\uFF0C\u8FD4\u56DE\u7684\u8FD9\u90E8\u5206\u6570\u636E\u662F\u6587\u672C\u7C7B\u578B\uFF0C\u4F7F\u7528 html \u65B9\u5F0F\u6765\u89E3\u6790\u5373\u53EF\u3002</li><li>content-length\uFF1A \u54CD\u5E94\u5185\u5BB9\u7684\u957F\u5EA6 \uFF0Ccontent-length:336, \u4ECE\u670D\u52A1\u5668\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668\u7684\u6570\u636E\u603B\u957F\u5EA6\u4E3A 336 \u5B57\u8282</li></ul></li></ul><p>\u54CD\u5E94\u884C\u54CD\u5E94\u5934\uFF1A <img src="'+e+'" alt="123"> \u54CD\u5E94\u4F53: <img src="'+o+`" alt="123"></p><h3 id="_9-4-\u5E38\u89C1\u7684\u72B6\u6001\u7801" tabindex="-1"><a class="header-anchor" href="#_9-4-\u5E38\u89C1\u7684\u72B6\u6001\u7801" aria-hidden="true">#</a> 9.4 \u5E38\u89C1\u7684\u72B6\u6001\u7801</h3><blockquote><p>200 ok ----- \u8BF7\u6C42\u6210\u529F</p></blockquote><blockquote><p>302 redirect|Found ----- \u91CD\u5B9A\u5411 \uFF08\u9875\u9762\u8DF3\u8F6C\uFF09</p></blockquote><blockquote><p>304 not modified ----- \u672A\u4FEE\u6539</p></blockquote><blockquote><p>403 forbidden ----- \u7981\u6B62\u8BBF\u95EE \uFF08\u6CA1\u6709\u6743\u9650\u8BBF\u95EE\uFF09</p></blockquote><blockquote><p>404 Not Found ----- \u672A\u627E\u5230\u9875\u9762</p></blockquote><blockquote><p>500 internal server error ----- \u670D\u52A1\u5668\u5185\u90E8\u9519\u8BEF (\u53EF\u80FD\u662F\u670D\u52A1\u5668\u672C\u8EAB\u6709\u95EE\u9898\uFF0C\u6216\u8005\u4EE3\u7801\u9519\u7684\u592A\u79BB\u8C31)</p></blockquote><h2 id="_10-req-\u8BF7\u6C42\u5BF9\u8C61\u548C-res-\u54CD\u5E94\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#_10-req-\u8BF7\u6C42\u5BF9\u8C61\u548C-res-\u54CD\u5E94\u5BF9\u8C61" aria-hidden="true">#</a> 10 req \u8BF7\u6C42\u5BF9\u8C61\u548C res \u54CD\u5E94\u5BF9\u8C61</h2><h3 id="_10-1-req-\u8BF7\u6C42\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#_10-1-req-\u8BF7\u6C42\u5BF9\u8C61" aria-hidden="true">#</a> 10.1 req \u8BF7\u6C42\u5BF9\u8C61</h3><p>req.url: \u6D4F\u89C8\u5668\u8BF7\u6C42\u7684\u8DEF\u5F84 req.method: \u6D4F\u89C8\u5668\u8BF7\u6C42\u65B9\u5F0F req.headers: \u8BBE\u7F6E\u8BF7\u6C42\u5934\u4FE1\u606F</p><h3 id="_10-2-res-\u54CD\u5E94\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#_10-2-res-\u54CD\u5E94\u5BF9\u8C61" aria-hidden="true">#</a> 10.2 res \u54CD\u5E94\u5BF9\u8C61</h3><p>res.setHeader()\uFF1A \u8BBE\u7F6E\u54CD\u5E94\u5934\u4FE1\u606F</p><blockquote><blockquote><p>\u4E0D\u8BBA\u6B64\u5904\u8BBE\u7F6E\u4E86\u4EC0\u4E48\u4FE1\u606F\uFF0C\u90FD\u4F1A\u8DDF\u7740\u54CD\u5E94\u5934\u4E00\u8D77\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668</p></blockquote></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;content-type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;text/html;charset=utf-8&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u8BE5\u4EE3\u7801\u5C31\u662F\u670D\u52A1\u5668\u544A\u8BC9\u6D4F\u89C8\u5668\u8FD4\u56DE\u7684data\u6570\u636E\uFF0C\u8981\u4EE5\u89E3\u6790html\u6587\u4EF6\u7684\u5F62\u5F0F\u6765\u89E3\u6790</span>
res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;content-type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;image/jpeg&#39;</span><span class="token punctuation">)</span>
<span class="token comment">//\u670D\u52A1\u5668\u544A\u8BC9\u6D4F\u89C8\u5668\uFF0C\u8FD4\u56DE\u7684data\u6570\u636E\uFF0C\u8981\u4EE5\u89E3\u6790jpg\u56FE\u7247\u7684\u5F62\u5F0F\u6765\u89E3\u6790</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>res.writeHeader()\uFF1A \u8BBE\u7F6E\u54CD\u5E94\u5934\u4FE1\u606F\u548C\u72B6\u6001\u7801</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u53C2\u65701\uFF1A \u8BBE\u7F6E\u8FD4\u56DE\u7684\u72B6\u6001\u7801   \u53C2\u65702 \u8BBE\u7F6E\u54CD\u5E94\u5934---\u5BF9\u8C61\u683C\u5F0F</span>
res<span class="token punctuation">.</span><span class="token function">writeHeader</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">&#39;content-type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;text/html&#39;</span><span class="token punctuation">,</span> <span class="token string-property property">&#39;set-cookie&#39;</span><span class="token operator">:</span> <span class="token string">&#39;name=zs&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>res.write(): \u8BBE\u7F6E\u54CD\u5E94\u4F53(\u4E0D\u5E38\u7528)</p><blockquote><blockquote><p>\u5199\u4E86 write \u4E5F\u5F97\u5199 end\uFF0C\u901A\u5E38 end \u7684\u5185\u5BB9\u662F\u8DDF\u968F\u54CD\u5E94\u4F53\u4E00\u8D77\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668\u7684</p></blockquote></blockquote><p>res.end(): \u5C06\u54CD\u5E94\u884C\u3001\u54CD\u5E94\u5934\u3001\u54CD\u5E94\u4F53\u4E00\u6B21\u6027\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668</p><h2 id="_11-express-\u6846\u67B6" tabindex="-1"><a class="header-anchor" href="#_11-express-\u6846\u67B6" aria-hidden="true">#</a> 11 express \u6846\u67B6</h2><h3 id="_11-1-\u4F7F\u7528-express-\u6784\u9020-web-\u670D\u52A1\u5668" tabindex="-1"><a class="header-anchor" href="#_11-1-\u4F7F\u7528-express-\u6784\u9020-web-\u670D\u52A1\u5668" aria-hidden="true">#</a> 11.1 \u4F7F\u7528 express \u6784\u9020 web \u670D\u52A1\u5668</h3><ul><li>\u5B89\u88C5\uFF1A</li></ul><div class="language-node ext-node line-numbers-mode"><pre class="language-node"><code>npm install express
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5F15\u5165express\u6A21\u5757</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u8C03\u7528express\u6A21\u5757 \u8BBE\u7F6E\u670D\u52A1\u5668\u540D\u4E3Aapp</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// \u5F00\u542F\u670D\u52A1\u5668 \u8BBE\u7F6E\u7AEF\u53E3\u53F7\u4E3A3000</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;expressServer is running...&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li><p>\u6D41\u7A0B\uFF1A</p><ul><li>\u52A0\u8F7D express \u6A21\u5757 const express = require(&#39;express&#39;);</li><li>\u521B\u5EFA express \u670D\u52A1\u5668 const app = express();</li><li>\u5F00\u542F express \u670D\u52A1\u5668 app.listen(3000, () =&gt; {})</li><li>\u76D1\u542C\u8DEF\u7531 app.get(url, callback) app.post(url, callback)</li></ul></li><li><p>\u4F9D\u7136\u5206\u4E24\u79CD\u8BF7\u6C42\uFF1Aget \u548C post</p></li></ul><h3 id="_11-2-\u8DEF\u7531" tabindex="-1"><a class="header-anchor" href="#_11-2-\u8DEF\u7531" aria-hidden="true">#</a> 11.2 \u8DEF\u7531</h3><p>\u5B9A\u4E49\uFF1A\u7B80\u5355\u6765\u8BF4\uFF0C\u8DEF\u7531\u5C31\u662F\u6D4F\u89C8\u5668\u4E2D url \u5730\u5740\u548C app.get/app.post \u65B9\u6CD5\u4E2D\u53C2\u6570 1 \u7684\u5BF9\u5E94\u7684\u5173\u7CFB \u4EE3\u7801\u4E3E\u4F8B\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>\u6D4F\u89C8\u5668\u5730\u5740\uFF1A http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">3000</span><span class="token operator">/</span>index

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

\u6D4F\u89C8\u5668\u5730\u5740\uFF1A http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">3000</span><span class="token operator">/</span>goods<span class="token operator">/</span>list

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/goods/list&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_11-3-sendfile-\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_11-3-sendfile-\u65B9\u6CD5" aria-hidden="true">#</a> 11.3 sendFile()\u65B9\u6CD5</h3><p>\u76F4\u63A5\u8BFB\u53D6\u6587\u4EF6\u5185\u5BB9\u5E76\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668 ==\u91CD\u70B9: \u6587\u4EF6\u8DEF\u5F84\u5FC5\u987B\u662F\u4E00\u4E2A\u7EDD\u5BF9\u8DEF\u5F84\u3002\u4E24\u79CD\u65B9\u6CD5:1. \u53C2\u6570 1 \u76F4\u63A5\u8BBE\u7F6E\u4E3A\u7EDD\u5BF9\u8DEF\u5F84\uFF1B2. \u53C2\u6570 1 \u548C\u53C2\u6570 2 \u7EC4\u6210\u4E00\u4E2A\u7EDD\u5BF9\u8DEF\u5F84==</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var2<span class="token punctuation">,</span> var3<span class="token punctuation">)</span><span class="token punctuation">;</span>
\u53C2\u6570<span class="token number">1</span>\uFF1A \u8981\u8BFB\u53D6\u7684\u6587\u4EF6\u8DEF\u5F84
\u53C2\u6570<span class="token number">2</span>\uFF1A \u914D\u7F6E\u9879\uFF0C\u53EF\u9009\uFF0C\u4E00\u822C\u4E0D\u7528
\u53C2\u6570<span class="token number">3</span>\uFF1A \u8BFB\u53D6\u5B8C\u6210\u540E\u7684\u56DE\u8C03\u51FD\u6570\uFF0C\u8BE5\u51FD\u6570\u4E2D\u6709\u4E00\u4E2A\u53C2\u6570 <span class="token operator">--</span><span class="token operator">-</span> \u9519\u8BEF\u5BF9\u8C61

\u53C2\u6570<span class="token number">2</span>\u793A\u4F8B\uFF1A
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">root</span><span class="token operator">:</span> __dirname <span class="token operator">+</span> <span class="token string">&#39;/view/&#39;</span><span class="token punctuation">,</span>   <span class="token comment">// \u914D\u7F6E\u6A21\u677F\u6587\u4EF6\u8DDF\u8DEF\u5F84</span>
    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>					  <span class="token comment">// \u914D\u7F6E\u5934\u4FE1\u606F  \u4E0D\u5E38\u7528</span>
        <span class="token string-property property">&#39;content-type&#39;</span><span class="token operator">:</span><span class="token string">&#39;text/html;charset=utf-8&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;express-server is running...&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendfile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>\u6848\u4F8B\uFF1A \u76EE\u6807\uFF1A \u663E\u793A view \u76EE\u5F55\u4E0B\uFF0C index.html \u548C login.html \u4E24\u4E2A\u9875\u9762</p><pre><code>             url\u5730\u5740\u4E3A  127.0.0.1:3000/index  \u65F6\u663E\u793A index.html

             url\u5730\u5740\u4E3A  127.0.0.1:3000/login \u65F6\u663E\u793A login.html
</code></pre><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;login&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;login.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_11-4-\u7EDF\u4E00\u5904\u7406\u9759\u6001\u8D44\u6E90-\u9759\u6001\u8D44\u6E90\u6258\u7BA1" tabindex="-1"><a class="header-anchor" href="#_11-4-\u7EDF\u4E00\u5904\u7406\u9759\u6001\u8D44\u6E90-\u9759\u6001\u8D44\u6E90\u6258\u7BA1" aria-hidden="true">#</a> 11.4 \u7EDF\u4E00\u5904\u7406\u9759\u6001\u8D44\u6E90/\u9759\u6001\u8D44\u6E90\u6258\u7BA1</h3><ul><li>\u4F7F\u7528 app.use()\u65B9\u6CD5</li><li>\u7EDF\u4E00\u5904\u7406\u9875\u9762\u4E2D\u9759\u6001\u8D44\u6E90\uFF1Acss,js,img \u7B49\u6587\u4EF6</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//url\u5730\u5740\u4E2D\u4EE5 /public \u5F00\u5934\u7684\uFF0C\u90FD\u4F1A\u53BB public \u76EE\u5F55\u4E0B\u8BFB\u53D6\u5BF9\u5E94\u7684\u6587\u4EF6\u5E76\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/public&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">&#39;./public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// \u76F8\u5BF9\u8DEF\u5F84</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/public&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// \u7EDD\u5BF9\u8DEF\u5F84</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//url\u5730\u5740\u4E2D\u6240\u6709\u7684\u6587\u4EF6\u90FD\u548C ./view \u62FC\u63A5\u8DEF\u5F84\uFF0C\u5E76\u6839\u636E\u62FC\u63A5\u597D\u7684\u8DEF\u5F84\u8BFB\u53D6\u6587\u4EF6\u5E76\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668</span>
<span class="token comment">// \u5373\uFF1A\u6D4F\u89C8\u5668\u7684url\u548C./view\u62FC\u63A5\u540E\u8BFB\u53D6\u6587\u4EF6\uFF0C\u7136\u540E\u518D\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668</span>
<span class="token comment">// http://127.0.0.1:3000/index.html ---&gt; ./view/index.html</span>
<span class="token comment">// http://127.0.0.1:3000/aaa/bbb.html ---&gt; ./view/aaa/bbb.html</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">&#39;./view&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_11-5-\u7EFC\u5408\u6848\u4F8B-\u663E\u793A\u7559\u8A00\u677F" tabindex="-1"><a class="header-anchor" href="#_11-5-\u7EFC\u5408\u6848\u4F8B-\u663E\u793A\u7559\u8A00\u677F" aria-hidden="true">#</a> 11.5 \u7EFC\u5408\u6848\u4F8B\uFF1A\u663E\u793A\u7559\u8A00\u677F</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5F15\u5165express\u6A21\u5757</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u8C03\u7528express\u6A21\u5757 \u8BBE\u7F6E\u670D\u52A1\u5668\u540D\u4E3Aapp</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// \u5F00\u542F\u670D\u52A1\u5668 \u8BBE\u7F6E\u7AEF\u53E3\u53F7\u4E3A3000</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;expressServer is running...&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// // \u914D\u7F6Eapp.get\u7684\u53C2\u65702</span>
<span class="token comment">// const config = {</span>
<span class="token comment">//     root: __dirname + &#39;/view&#39;</span>
<span class="token comment">// }</span>
<span class="token comment">// // \u6B63\u5E38\u7528\u6CD5\u4E0D\u5199\u53C2\u65702</span>
<span class="token comment">// app.get(&#39;/index&#39;, (req, res) =&gt; {</span>
<span class="token comment">//     res.sendFile(path.join(&#39;index.html&#39;), config, (err) =&gt; {</span>
<span class="token comment">//         console.log(err);</span>
<span class="token comment">//     });</span>
<span class="token comment">// });</span>

<span class="token comment">// \u5F00\u542F\u76D1\u542C\u6D4F\u89C8\u5668\u8BF7\u6C42  \u529F\u80FD\u76F8\u5F53\u4E8Eif()else if fs.readFile........</span>
<span class="token comment">// \u5982\u679C\u8F93\u5165\u7684\u662F/index \u8FD4\u56DE\u56DE\u8C03\u51FD\u6570</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//\u8BFB\u53D6\u6587\u4EF6 \u5E76\u53D1\u9001\u7ED9\u670D\u52A1\u5668  \u53C2\u65701:\u8FD4\u56DE\u6587\u4EF6\u7684\u7EDD\u5BF9\u8DEF\u5F84 \u53C2\u65702\uFF1A\u770B\u4E0A\u9762 \u53C2\u65703\uFF1A\u56DE\u8C03\u51FD\u6570\uFF0C\u50A8\u5B58\u4E86\u9519\u8BEF\u4FE1\u606F \u65E0\u9519\u8BEFerr\u662Fundefined</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;/view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token comment">//\u6CA1\u9519\u8BEF\u7684\u65F6\u5019err\u662Fundefined</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u76D1\u542Cpost.html\u9875\u9762</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/post&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;post.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> config<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// .use\u65B9\u6CD5\uFF1A\u6240\u6709\u4EE5/public\u5F00\u5934\u7684\u6587\u4EF6\u90FD\u8BFB\u53D6</span>
<span class="token comment">// \u53C2\u65701\uFF1A\u8BBE\u7F6E\u4EE5/public\u5F00\u5934\u7684\u6587\u4EF6</span>
<span class="token comment">// \u53C2\u65702\uFF1A\u53BBstatic()\u6240\u8BBE\u7F6E\u7684\u76EE\u5F55\u4E0B\u8BFB\u53D6  \u8BE5\u53C2\u6570\u7684\u8DEF\u5F84\u53EF\u4EE5\u662F\u76F8\u5BF9\u8DEF\u5F84 \u4E5F\u53EF\u4EE5\u662F\u89C9\u5F97\u8DEF\u5F84</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/public&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// app.use(express.static(&#39;./view&#39;));//\u4E5F\u53EF\u4EE5\u4E0D\u5199\u7B2C\u4E00\u4E2A\u53C2\u6570 \uFF08\u4E0D\u5E38\u7528\uFF09</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h2 id="_12-express-\u4E2D\u4F7F\u7528-art-template" tabindex="-1"><a class="header-anchor" href="#_12-express-\u4E2D\u4F7F\u7528-art-template" aria-hidden="true">#</a> 12 express \u4E2D\u4F7F\u7528 art-template</h2><p>\u5728 Express \u6846\u67B6\u4E2D\u4E0D\u8981\u76F4\u63A5\u4F7F\u7528 art-template \u6A21\u677F\u5F15\u64CE\uFF0C\u4F7F\u7528 Express-art-template \u4E2D\u95F4\u4EF6\u6765\u52A0\u8F7D\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u8981\u5728node\u4E2D\u5B89\u88C5template\u6A21\u5757</span>
npm i art<span class="token operator">-</span>template express<span class="token operator">-</span>art<span class="token operator">-</span>template
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> dataArr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">goods_name</span><span class="token operator">:</span> <span class="token string">&#39;\u9633\u5149\u7F8E\u5305\u65B0\u6B3E\u5355\u80A9\u5305\u5973\u5305\u65F6\u5C1A\u5B50\u6BCD\u5305\u56DB\u4EF6\u5957\u5973&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">goods_price</span><span class="token operator">:</span> <span class="token string">&#39;116.00&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">goods_pic</span><span class="token operator">:</span> <span class="token string">&#39;uploads/like_01.png&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">goods_name</span><span class="token operator">:</span> <span class="token string">&#39;\u7231\u4ED5\u8FBE 30CM\u7092\u9505\u4E0D\u7C98\u9505NWG8330E\u7535\u78C1\u7089\u7092&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">goods_price</span><span class="token operator">:</span> <span class="token string">&#39;1161.00&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">goods_pic</span><span class="token operator">:</span> <span class="token string">&#39;uploads/like_02.png&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">goods_name</span><span class="token operator">:</span> <span class="token string">&#39;\u6377\u6CE2\u6717\u84DD\u7259\u8033\u673A&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">goods_price</span><span class="token operator">:</span> <span class="token string">&#39;116.00&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">goods_pic</span><span class="token operator">:</span> <span class="token string">&#39;uploads/like_03.png&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">goods_name</span><span class="token operator">:</span> <span class="token string">&#39;\u5927\u65B9\u5757\uFF0C\u4E0D\u77E5\u9053\u662F\u5E72\u4EC0\u4E48\u7528\u7684&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">goods_price</span><span class="token operator">:</span> <span class="token string">&#39;2116.00&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">goods_pic</span><span class="token operator">:</span> <span class="token string">&#39;uploads/like_04.png&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">goods_name</span><span class="token operator">:</span> <span class="token string">&#39;\u4E09\u661F\uFF08G5500\uFF09&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">goods_price</span><span class="token operator">:</span> <span class="token string">&#39;1816.00&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">goods_pic</span><span class="token operator">:</span> <span class="token string">&#39;uploads/like_05.png&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">goods_name</span><span class="token operator">:</span> <span class="token string">&#39;\u597D\u50CF\u662F\u4E2A\u6D17\u624B\u6DB2&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">goods_price</span><span class="token operator">:</span> <span class="token string">&#39;3116.00&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">goods_pic</span><span class="token operator">:</span> <span class="token string">&#39;uploads/like_06.png&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;epxerss-server is running...&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// \u5F15\u5165express\u4E0B\u7684\u6A21\u677F\u5F15\u64CE\u6A21\u5757</span>
<span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express-art-template&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u8C03\u7528\u6A21\u677F\u5F15\u64CE\u6A21\u5757</span>
<span class="token comment">//\u53C2\u65701: \u6A21\u677F\u6587\u4EF6\u7684\u540E\u7F00\uFF0C\u6B64\u5904\u53EF\u4EE5\u968F\u610F\u5B9A\u4E49\u3002 \u5B9A\u4E49\u6210\u4EC0\u4E48\uFF0C\u6A21\u677F\u6587\u4EF6\u540E\u7F00\u5C31\u662F\u4EC0\u4E48\u3002\u4E00\u822C\u4F7F\u7528html\u5373\u53EF</span>
<span class="token comment">//\u53C2\u65702: \u6A21\u677F\u5F15\u64CE\u5BF9\u8C61</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">&#39;html&#39;</span><span class="token punctuation">,</span> template<span class="token punctuation">)</span>
<span class="token comment">// \u8BB2\u5176\u653E\u5230get\u76D1\u542C\u4E0B\u7684res\u4E2D</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u52A0\u5165\u5230\u9875\u9762\u91CC\uFF1A\u7B2C\u4E00\u4E2A\u53C2\u6570\u662F\u8981\u653E\u5165\u7684html\u8DEF\u5F84\uFF0C\u7B2C\u4E8C\u4E2A\u53C2\u6570\u662F\u6570\u636E\u5BF9\u8C61</span>
  <span class="token comment">//render\u65B9\u6CD5\u662Fexpress\u63D0\u4F9B\u597D\u7684\u65B9\u6CD5\uFF0C\u4E0D\u7BA1\u6211\u4EEC\u4F7F\u7528\u4EC0\u4E48\u6A21\u677F\u5F15\u64CE\u90FD\u80FD\u4F7F\u7528\u8BE5\u65B9\u6CD5\u6E32\u67D3\u9875\u9762</span>
  <span class="token comment">//\u53C2\u65701: \u6A21\u677F\u6587\u4EF6\u8DEF\u5F84</span>
  <span class="token comment">//\u53C2\u65702: \u8981\u6E32\u67D3\u5230\u9875\u9762\u7684json\u6570\u636E</span>
  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">list</span><span class="token operator">:</span> dataArr<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/styles&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;styles&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/images&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;images&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/script&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;script&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/fonts&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;fonts&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/uploads&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;uploads&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><h2 id="_13-express-\u4E2D\u7684-get-\u65B9\u5F0F\u63D0\u4EA4\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_13-express-\u4E2D\u7684-get-\u65B9\u5F0F\u63D0\u4EA4\u6570\u636E" aria-hidden="true">#</a> 13 express \u4E2D\u7684 get \u65B9\u5F0F\u63D0\u4EA4\u6570\u636E</h2><h3 id="_13-1-\u4F7F\u7528-query-\u63A5\u6536-get-\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_13-1-\u4F7F\u7528-query-\u63A5\u6536-get-\u6570\u636E" aria-hidden="true">#</a> 13.1 \u4F7F\u7528 query \u63A5\u6536 get \u6570\u636E</h3><blockquote><p>url \u5730\u5740\uFF1A http://127.0.0.1:3000/index?id=10001&amp;name=zs</p></blockquote><blockquote><p>req.query \u4E2D\u4EE5\u5BF9\u8C61\u5F62\u5F0F\u4FDD\u5B58\u4E86 get \u53C2\u6570\uFF1A {id\uFF1A10001, name:&quot;zs&quot;};</p></blockquote><blockquote><p>console.log(req.query.id);</p></blockquote><blockquote><p>console.log(req.query.name); \u5B9E\u73B0\u4EE3\u7801:</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> dataArr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;\u540E\u7FBF&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">&#39;\u5468\u65E5\u90FD\u8BA9\u6211\u5C04\u7184\u706B\u4E86&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token string">&#39;2018-10-10&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u9759\u6001\u8D44\u6E90\u6258\u7BA1</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/public&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// \u6A21\u677F\u5F15\u64CE\u4F7F\u7528</span>
<span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express-art-template&#39;</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">&#39;html&#39;</span><span class="token punctuation">,</span> template<span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;express-server is running...&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">list</span><span class="token operator">:</span> dataArr<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/post&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;post.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u76D1\u542C\u70B9\u51FB\u63D0\u4EA4\u6309\u94AE\u540E\u7684addpost\u9875\u9762</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/addpost&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// req.query\u4E2D\u4EE5\u5BF9\u8C61\u5F62\u5F0F\u4FDD\u5B58\u4E86get\u53C2\u6570\uFF1A {id\uFF1A10001, name:&quot;zs&quot;}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;data has been upload.&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h3 id="_13-2-\u4F7F\u7528-params-\u63A5\u6536-get-\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_13-2-\u4F7F\u7528-params-\u63A5\u6536-get-\u6570\u636E" aria-hidden="true">#</a> 13.2 \u4F7F\u7528 params \u63A5\u6536 get \u6570\u636E</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// url\u5730\u5740\uFF1A http://127.0.0.1:3000/index/10/ls</span>
<span class="token comment">// req.params\u4E2D\u4EE5\u5BF9\u8C61\u5F62\u5F0F\u4FDD\u5B58\u4E86get\u53C2\u6570</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index/:id/:name&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token comment">// req.params = {id:10, name:&quot;ls&quot;}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// http://127.0.0.1:3000/index/10/ls \u548C  /index/:id/:name</span>
<span class="token comment">// \u914D\u5408\u8D77\u6765\u5C31\u76F8\u5F53\u4E8E  http://127.0.0.1:3000/index?id=10&amp;name=ls</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u76D1\u542C\u70B9\u51FB\u63D0\u4EA4\u6309\u94AE\u540E\u7684addpost\u9875\u9762</span>
<span class="token comment">// \u6CE8\u610F\uFF01 \u6CE8\u610F\uFF01\uFF1A</span>
<span class="token comment">// html\u9875\u9762\u8981\u5199\u5BF9\u5E94\u7684id\u548Cname \u6B64\u65B9\u6CD5\u591A\u7528\u4E8E\u8FDE\u63A5\u8DF3\u8F6C</span>
<span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">&quot;/addpost/12/11&quot;</span> method<span class="token operator">=</span><span class="token string">&quot;GET&quot;</span><span class="token operator">&gt;</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/addpost/:id/:name&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// req.query\u4E2D\u4EE5\u5BF9\u8C61\u5F62\u5F0F\u4FDD\u5B58\u4E86get\u53C2\u6570\uFF1A {id\uFF1A10001, name:&quot;zs&quot;}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;data has been upload.&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_14-express-\u4E2D\u7684-post-\u65B9\u5F0F\u63D0\u4EA4\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_14-express-\u4E2D\u7684-post-\u65B9\u5F0F\u63D0\u4EA4\u6570\u636E" aria-hidden="true">#</a> 14 express \u4E2D\u7684 post \u65B9\u5F0F\u63D0\u4EA4\u6570\u636E</h2><p>\u4F7F\u7528 body-parser \u7B2C\u4E09\u65B9\u6A21\u5757 \u5B89\u88C5\u6A21\u5757:npm i body-parser \u5B9E\u73B0\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;body-parser&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u6CE8\u518C\u4E2D\u95F4\u4EF6\uFF1A{extended\uFF1Afalse} \u4EE3\u8868\u4F7F\u7528node\u7684 querystring \u6A21\u5757\u6765\u89E3\u6790\u8868\u5355\u6570\u636E</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// \u4F7F\u7528post\u65B9\u6CD5\u76D1\u542CmyLogin\u5730\u5740</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/myLogin&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// req.body\u5BF9\u8C61\u5B58\u50A8\u4E86\u8868\u5355\u6570\u636E</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;data has been upload.&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_14-1-express-\u5B8C\u6574\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#_14-1-express-\u5B8C\u6574\u5E94\u7528" aria-hidden="true">#</a> 14.1 express \u5B8C\u6574\u5E94\u7528</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;body-parser&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// \u4F7F\u7528body-parse\u63D2\u4EF6 \u63A5\u6536post\u53C2\u6570</span>
<span class="token comment">// \u6CE8\u518C\u4E2D\u95F4\u4EF6\uFF1A{extended\uFF1Afalse} \u4EE3\u8868\u4F7F\u7528node\u7684 querystring \u6A21\u5757\u6765\u89E3\u6790\u8868\u5355\u6570\u636E</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3001</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;express server is running on port 3001&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/public&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// \u6258\u7BA1public\u4E0B\u7684\u9759\u6001\u8D44\u6E90\u6587\u4EF6 css img js\u7B49</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u8BFB\u53D6html\u6587\u4EF6\u5939\u4E0B\u7684index.html\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;html&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;err&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/base&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u8BFB\u53D6html\u6587\u4EF6\u5939\u4E0B\u7684base.html\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;html&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;base.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// post\u8BF7\u6C42</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/queryList&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u524D\u7AEF\u4F20\u53C2:</span>
  <span class="token comment">// const ajax = () =&gt; {</span>
  <span class="token comment">//   fetch(&#39;http://localhost:3001/queryList&#39;, {</span>
  <span class="token comment">//     method: &#39;POST&#39;,</span>
  <span class="token comment">//     headers: {</span>
  <span class="token comment">//       &#39;Content-Type&#39;: &#39;application/json&#39;,</span>
  <span class="token comment">//     },</span>
  <span class="token comment">//     body: JSON.stringify({ id: 123, name: &#39;zs&#39; }),</span>
  <span class="token comment">//   })</span>
  <span class="token comment">//     .then((response) =&gt; response.json())</span>
  <span class="token comment">//     .then((res) =&gt; {</span>
  <span class="token comment">//       console.log(res)</span>
  <span class="token comment">//     })</span>
  <span class="token comment">// }</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;req&#39;</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">)</span> <span class="token comment">// \u63A5\u6536\u524D\u7AEF\u8BF7\u6C42\u4F53\u4E2D\u7684\u53C2\u6570</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">data</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">,</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&#39;success&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&#39;\u7F3A\u5C11\u5FC5\u8981\u53C2\u6570id&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// get\u4E24\u79CD\u8BF7\u6C42</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/getListByQuery&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u524D\u7AEF\u4F20\u53C2: http://localhost:3001/getListByQuery?id=1&amp;name=zs</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;req&#39;</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>query<span class="token punctuation">)</span> <span class="token comment">// { id: &#39;1&#39;, name: &#39;zs&#39; }</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">data</span><span class="token operator">:</span> req<span class="token punctuation">.</span>query<span class="token punctuation">,</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&#39;success&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/getListByParams/:id/:name&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u524D\u7AEF\u4F20\u53C2: http://localhost:3001/getListByParams/1/zs</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;req&#39;</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>params<span class="token punctuation">)</span> <span class="token comment">// { id: &#39;1&#39;, name: &#39;zs }</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">data</span><span class="token operator">:</span> req<span class="token punctuation">.</span>params<span class="token punctuation">,</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&#39;success&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><h2 id="_15-mysql-\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#_15-mysql-\u6A21\u5757" aria-hidden="true">#</a> 15 mysql \u6A21\u5757</h2><h3 id="_15-1-mysql-\u6A21\u5757\u7684\u4F5C\u7528" tabindex="-1"><a class="header-anchor" href="#_15-1-mysql-\u6A21\u5757\u7684\u4F5C\u7528" aria-hidden="true">#</a> 15.1 mysql \u6A21\u5757\u7684\u4F5C\u7528</h3><p>\u7B2C\u4E09\u65B9\u6A21\u5757\uFF0C\u7528\u6765\u64CD\u4F5C mysql \u6570\u636E\u5E93\uFF0C\u53EF\u4EE5\u8FDB\u884C\u589E(creat)\u5220(delete)\u6539(update)\u67E5(read)</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i mysql
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="_15-2-\u67E5\u8BE2-read" tabindex="-1"><a class="header-anchor" href="#_15-2-\u67E5\u8BE2-read" aria-hidden="true">#</a> 15.2 \u67E5\u8BE2 --- read</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5F15\u5165mysql\u6A21\u5757</span>
<span class="token keyword">const</span> mysql <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mysql&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u521B\u5EFA\u94FE\u63A5\u5BF9\u8C61</span>
<span class="token keyword">const</span> conn <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&#39;127.0.0.1&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token string">&#39;school&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// \u94FE\u63A5mysql\u670D\u52A1\u5668</span>
conn<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u5B9A\u4E49sql</span>
<span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;select * from student&#39;</span>
<span class="token comment">// \u6267\u884Csql\u8BED\u53E5</span>
conn<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u5173\u95ED\u8FDE\u63A5</span>
conn<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_15-4-\u6DFB\u52A0-create" tabindex="-1"><a class="header-anchor" href="#_15-4-\u6DFB\u52A0-create" aria-hidden="true">#</a> 15.4 \u6DFB\u52A0 --- create</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> mysql <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mysql&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> conn <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&#39;127.0.0.1&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token string">&#39;school&#39;</span><span class="token punctuation">,</span> <span class="token comment">//\u8981\u521B\u5EFA\u7684\u6570\u636E\u5E93\u540D\u79F0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
conn<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;insert into student values(null, &quot;\u7EAF\u5B50&quot;, ?, ?, &quot;2019-03-21&quot;)&#39;</span> <span class="token comment">//student\u662F\u8981\u4FEE\u6539\u7684\u8868\u540D\u79F0</span>
conn<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;\u5973&#39;</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
conn<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_15-5-\u4FEE\u6539-update" tabindex="-1"><a class="header-anchor" href="#_15-5-\u4FEE\u6539-update" aria-hidden="true">#</a> 15.5 \u4FEE\u6539 --- update</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> mysql <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mysql&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> conn <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&#39;127.0.0.1&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token string">&#39;school&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
conn<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;update student set sname=&quot;\u5C0F\u987E&quot;,sage=19 where sno=9&#39;</span>
conn<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
conn<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_15-6-\u5220\u9664-delete" tabindex="-1"><a class="header-anchor" href="#_15-6-\u5220\u9664-delete" aria-hidden="true">#</a> 15.6 \u5220\u9664 --- delete</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> mysql <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mysql&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> conn <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&#39;127.0.0.1&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token string">&#39;school&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
conn<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;delete from student where sno=6&#39;</span>
conn<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
conn<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="_16-node-\u6A21\u5757\u5316" tabindex="-1"><a class="header-anchor" href="#_16-node-\u6A21\u5757\u5316" aria-hidden="true">#</a> 16 node \u6A21\u5757\u5316</h2><h3 id="_16-1-module-exports-\u5BFC\u51FA\u5C5E\u6027\u548C\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_16-1-module-exports-\u5BFC\u51FA\u5C5E\u6027\u548C\u65B9\u6CD5" aria-hidden="true">#</a> 16.1 module.exports \u5BFC\u51FA\u5C5E\u6027\u548C\u65B9\u6CD5</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//1. \u52A0\u8F7D mysql \u6A21\u5757</span>
<span class="token keyword">const</span> mysql <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mysql&#39;</span><span class="token punctuation">)</span>

<span class="token comment">//2. \u521B\u5EFA mysql \u94FE\u63A5\u5BF9\u8C61</span>
<span class="token keyword">const</span> conn <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&#39;127.0.0.1&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token string">&#39;school&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//3. \u94FE\u63A5mysql\u670D\u52A1\u5668</span>
conn<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//4. \u5C06conn \u5BFC\u51FA</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> conn
<span class="token comment">// \u4E5F\u53EF\u5BFC\u51FA\u4E3A\u591A\u4E2A</span>
<span class="token comment">// module.exports = {conn1,conn2}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>\u4F7F\u7528\u65F6\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> conn <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./database.js&#39;</span><span class="token punctuation">)</span> <span class="token comment">//\u4E0A\u9762\u7684\u6587\u4EF6\u540D\u8DEF\u5F84</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="_16-2-\u7559\u8A00\u677F\u5217\u8868\u6848\u4F8B" tabindex="-1"><a class="header-anchor" href="#_16-2-\u7559\u8A00\u677F\u5217\u8868\u6848\u4F8B" aria-hidden="true">#</a> 16.2 \u7559\u8A00\u677F\u5217\u8868\u6848\u4F8B</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u52A0\u8F7Dexpress\u6A21\u5757</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u5F00\u542Fexpress</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// \u5F00\u542F\u76D1\u542C \u7AEF\u53E33000</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;server is running at 3000 port&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// \u52A0\u8F7Dpath\u6A21\u5757</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u9759\u6001\u8D44\u6E90\u6258\u7BA1</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/public&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// \u52A0\u8F7D\u6A21\u677F\u5F15\u64CE\u6A21\u5757</span>
<span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express-art-template&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u5F00\u542F\u6A21\u677F\u5F15\u64CE</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">&#39;html&#39;</span><span class="token punctuation">,</span> template<span class="token punctuation">)</span>
<span class="token comment">// \u52A0\u8F7Dmysql\u6A21\u5757</span>
<span class="token keyword">const</span> mysql <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mysql&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u521B\u5EFAmysql\u5BF9\u8C61</span>
<span class="token keyword">const</span> conn <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&#39;127.0.0.1&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token string">&#39;commentsData&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// \u5F00\u542F\u94FE\u63A5</span>
conn<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// \u5B9A\u4E49sql</span>
<span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;select * from comments&#39;</span>
<span class="token comment">// \u6267\u884Csql\u8BED\u53E5</span>
conn<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token comment">// \u76D1\u542C\u8DEF\u7531</span>
  app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u6A21\u677F\u5F15\u64CE\u8C03\u7528 \u52A8\u6001\u6E32\u67D3\u5230html\u4E2D</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> result<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h2 id="_17-\u6848\u4F8B-\u5B66\u751F\u7CFB\u7EDF" tabindex="-1"><a class="header-anchor" href="#_17-\u6848\u4F8B-\u5B66\u751F\u7CFB\u7EDF" aria-hidden="true">#</a> 17 \u6848\u4F8B\uFF1A\u5B66\u751F\u7CFB\u7EDF</h2><p>app.js \u90E8\u5206\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;stu-server is running&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//\u52A0\u8F7D\u6A21\u677F\u5F15\u64CE</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">&#39;html&#39;</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express-art-template&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// \u52A0\u8F7Dbody-parser\u6A21\u5757</span>
<span class="token keyword">const</span> bodyP <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;body-parser&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u4E2D\u95F4\u4EF6</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  bodyP<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment">// \u5230\u5904router\u6A21\u5757  \u6CE8\u518C\u4E3A\u4E2D\u95F4\u4EF6</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./router&#39;</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>router.js \u90E8\u5206\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u52A0\u8F7Dexpress\u6A21\u5757</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// \u521B\u5EFA\u8DEF\u7531\u5BF9\u8C61</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> moment <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;moment&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./db.js&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// \u6267\u884Csql  \u5B9E\u73B0index.html\u9875\u9762\u663E\u793A</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u5B9A\u4E49sql\u8BED\u53E5</span>
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">select infomation.*,school.schoolName from infomation
     join school on infomation.sdept=school.sid order by sno;</span><span class="token template-punctuation string">\`</span></span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> result<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u589E\u52A0\u6570\u636E\u529F\u80FD\u90E8\u5206</span>

<span class="token comment">//\u83B7\u53D6\u589E\u52A0\u6570\u636E\u9875\u9762</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/add&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;select * from school&#39;</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;add.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> result<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u63D0\u4EA4\u8868\u5355\u529F\u80FD</span>

<span class="token comment">// post\u65B9\u5F0F\u63D0\u4EA4\u8868\u5355\u6570\u636E</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/addInfo&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// req.body</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">sname</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    <span class="token literal-property property">sgender</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>gender<span class="token punctuation">,</span>
    <span class="token literal-property property">sage</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
    <span class="token literal-property property">stime</span><span class="token operator">:</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&#39;YYYY-MM-DD&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sdept</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>dept<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;insert into infomation set ?&#39;</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> restul</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u5220\u9664\u6570\u636E\u529F\u80FD\u90E8\u5206</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/delstu&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u63A5\u6536get\u63D0\u4EA4\u7684\u503C \u4F5C\u4E3A\u5220\u9664\u7684\u4F9D\u636E</span>
  <span class="token comment">// req.query.sno</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>sno
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;delete from infomation where sno=?&#39;</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//\u7F16\u8F91\u9875\u9762\u529F\u80FD\u90E8\u5206</span>

<span class="token comment">// \u83B7\u53D6\u7F16\u8F91\u9875\u9762\u6570\u636E</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/edit&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> sno <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>sno
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;select * from infomation where sno=?&#39;</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> sno<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">&#39;select * from school&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err2<span class="token punctuation">,</span> result2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err2<span class="token punctuation">)</span>
      <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">data1</span><span class="token operator">:</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data2</span><span class="token operator">:</span> result2<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
      res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;edit.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u4FEE\u6539\u7F16\u8F91\u9875\u9762\u6570\u636E</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/changeStu&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u63A5\u6536post\u4F20\u6765\u7684\u53C2\u6570</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">sname</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    <span class="token literal-property property">sgender</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>gender<span class="token punctuation">,</span>
    <span class="token literal-property property">sage</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
    <span class="token literal-property property">sdept</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>dept<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// \u63A5\u6536\u5F53\u524D\u70B9\u51FB\u7684\u884C\u6570 \u7528\u4E8E\u6570\u636E\u5E93\u67E5\u8BE2</span>
  <span class="token keyword">const</span> sno <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>no
  <span class="token comment">// \u5B9A\u4E49sql</span>
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;update infomation set ? where sno=?&#39;</span>
  <span class="token comment">// \u6267\u884Csql\u4FEE\u6539\u6570\u636E</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> sno<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/edit?sno=&#39;</span> <span class="token operator">+</span> sno<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u767B\u5F55\u9875\u9762</span>

<span class="token comment">// \u52A0\u8F7D\u767B\u5F55\u754C\u9762</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/login&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;login.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u83B7\u53D6\u6570\u636E\u548C\u6570\u636E\u5E93\u8FDB\u884C\u5BF9\u6BD4</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/login&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> u <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username
  <span class="token keyword">const</span> psd <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>password
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;select * from user where user=? and password=?&#39;</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">[</span>u<span class="token punctuation">,</span> psd<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token operator">||</span> result<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/login&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u5230\u5904router\u6A21\u5757</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br></div></div><p>\u5168\u90E8\u6848\u4F8B\u5728 node day8</p><h2 id="_18-\u4F1A\u8BDD\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#_18-\u4F1A\u8BDD\u63A7\u5236" aria-hidden="true">#</a> 18 \u4F1A\u8BDD\u63A7\u5236</h2><blockquote><p>\u4F1A\u8BDD\u63A7\u5236\u5C31\u662F\u89E3\u51B3 http \u65E0\u8BB0\u5FC6\u7684\u7F3A\u9677\u7684\u3002\u80FD\u591F\u5C06\u6570\u636E\u6301\u4E45\u5316\u7684\u4FDD\u5B58\u5728\u5BA2\u6237\u7AEF(\u6D4F\u89C8\u5668)\u6216\u8005\u670D\u52A1\u5668\u7AEF\uFF0C\u4ECE\u800C\u8BA9\u6D4F\u89C8\u5668\u548C\u670D\u52A1\u5668\u8FDB\u884C\u591A\u6B21\u6570\u636E\u4EA4\u6362\u65F6\uFF0C\u4EA7\u751F\u8FDE\u7EED\u6027\u3002</p></blockquote><ul><li>\u4F1A\u8BDD\u63A7\u5236\u7684\u5206\u7C7B <ul><li>cookie\uFF1A \u5C06\u6570\u636E\u6301\u4E45\u5316\u4FDD\u5B58\u5230\u5BA2\u6237\u7AEF\uFF08\u6D4F\u89C8\u5668\uFF09</li><li>session\uFF1A \u5C06\u6570\u636E\u6301\u4E45\u5316\u4FDD\u5B58\u5230\u670D\u52A1\u5668\u7AEF</li></ul></li></ul><blockquote><p>cookie \u6280\u672F</p></blockquote><ul><li><p>\u6838\u5FC3\uFF1Acookie \u662F\u968F\u7740\u54CD\u5E94\u5934\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668\u7684</p></li><li><p>\u8BBE\u7F6E cookie \u7684\u6838\u5FC3\u601D\u60F3\uFF1A \u4F7F\u7528 res.setHeader \u6216\u8005 res.writeHeader \u5C06 cookie \u4FE1\u606F\u8BBE\u7F6E\u5728\u54CD\u5E94\u5934\u4E2D</p></li><li><p>\u539F\u7406\uFF1A</p><ul><li><p>\u6D4F\u89C8\u5668\u7B2C\u4E00\u6B21\u8BBF\u95EE\u5E26\u6709 cookie \u8BBE\u7F6E\u7684\u8DEF\u7531\u65F6\uFF0C\u670D\u52A1\u5668\u4F1A\u5C06 cookie \u4FE1\u606F\u901A\u8FC7\u54CD\u5E94\u5934\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668</p></li><li><p>\u4E4B\u540E\u6D4F\u89C8\u5668\u6BCF\u6B21\u8BBF\u95EE\u670D\u52A1\u5668\u65F6\u90FD\u4F1A\u5C06 cookie \u4FE1\u606F\u901A\u8FC7\u8BF7\u6C42\u5934\u53D1\u9001\u7ED9\u670D\u52A1\u5668</p></li></ul></li></ul><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A</p><h3 id="_18-1-\u8BBE\u7F6E-cookie" tabindex="-1"><a class="header-anchor" href="#_18-1-\u8BBE\u7F6E-cookie" aria-hidden="true">#</a> 18.1 \u8BBE\u7F6E cookie</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//4.\u8BBE\u7F6Ecookie</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/setck&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u4E09\u4E2A\u65B9\u6CD5\u4EFB\u9009\u5176\u4E00 \u4E0D\u80FD\u90FD\u5199</span>

  <span class="token comment">// \u65B9\u6CD5\u4E00\uFF1A\u4F7F\u7528setHeader\u8BBE\u7F6Ecookie</span>
  <span class="token comment">// \u53C2\u65701: \u5728\u8BBE\u7F6Ecookie\u65F6\uFF0C\u6B64\u5904\u5FC5\u987B\u662F set-cookie</span>
  <span class="token comment">// \u53C2\u65702: \u5FC5\u987B\u662F\u4E00\u4E2A key=value \u7684\u683C\u5F0F\u3002</span>
  <span class="token comment">//  key\u5C31\u662Fcookie\u7684\u540D\u5B57\uFF1Bvalue\u5C31\u662F\u8BE5\u540D\u79F0\u5BF9\u5E94\u7684\u503C</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;set-cookie&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;keywords=phone&#39;</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;set-cookie&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;keywords=phone&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;name=ls&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;age=14&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token comment">// \u65B9\u6CD5\u4E8C\uFF1A\u4F7F\u7528writeHeader\u8BBE\u7F6Ecookie</span>
  <span class="token comment">// \u53C2\u65701: \u7ED9\u6D4F\u89C8\u5668\u7684\u72B6\u6001\u7801</span>
  <span class="token comment">// \u53C2\u65702: \u5BF9\u8C61\uFF0C\u54CD\u5E94\u5934\u4FE1\u606F\u90FD\u5199\u5728\u8BE5\u914D\u7F6E\u9879\u4E2D</span>
  res<span class="token punctuation">.</span><span class="token function">writeHeader</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&#39;content-type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;text/html;charset=utf-8&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;set-cookie&#39;</span><span class="token operator">:</span> <span class="token string">&#39;type=xiaomi&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// \u65B9\u6CD5\u4E09\uFF1A \u4F7F\u7528express\u6A21\u5757\u7684\u65B9\u6CD5 res.set();</span>
  res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;set-cookie&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;color=red&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;bgcolor=green&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_18-2-\u8BFB\u53D6-cookie" tabindex="-1"><a class="header-anchor" href="#_18-2-\u8BFB\u53D6-cookie" aria-hidden="true">#</a> 18.2 \u8BFB\u53D6 cookie</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//\u8BBE\u7F6E\u597Dcookie\u540E \u6D4F\u89C8\u5668\u518D\u6B21\u8BBF\u95EE\u670D\u52A1\u5668\u7684\u65F6\u5019\uFF0Ccookie\u7684\u4FE1\u606F\u5C31\u4F1A\u8DDF\u7740\u8BF7\u6C42\u5934\u4E00\u8D77\u53D1\u9001\u7ED9\u670D\u52A1\u5668</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span> <span class="token comment">//\u6CE8\u610F\uFF01req ! headers!</span>

<span class="token comment">//cookie\u662F\u4EE5\u5B57\u7B26\u4E32\u5F62\u5F0F\u4FDD\u5B58\u5728\u8BF7\u6C42\u5934\u4E2D\u7684\uFF0C\u4F7F\u7528\u7684\u8BDD\u9700\u8981\u8F6C\u6362\u6210\u5BF9\u8C61</span>
<span class="token comment">// &#39;goodsname=xiaomi8; goodsprice=2999&#39;</span>

<span class="token comment">//1. \u52A0\u8F7Dquerystring\u6A21\u5757</span>
<span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;querystring&#39;</span><span class="token punctuation">)</span>

<span class="token comment">//2. \u8C03\u7528parse\u65B9\u6CD5\u62C6\u89E3\u5B57\u7B26\u4E32</span>

<span class="token comment">//\u53C2\u65701: \u8981\u62C6\u89E3\u7684\u5B57\u7B26\u4E32</span>
<span class="token comment">//\u53C2\u65702: \u7B2C\u4E00\u6B21\u62C6\u5206\u4F7F\u7528\u7684\u5B57\u7B26\u6807\u8BB0</span>
<span class="token comment">//\u53C2\u65703: \u7B2C\u4E8C\u6B21\u62C6\u5206\u4F7F\u7528\u7684\u5B57\u7B26\u6807\u8BB0</span>
<span class="token comment">//\u8FD4\u56DE\u503C\uFF1A \u62C6\u5206\u597D\u7684\u5BF9\u8C61</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>cookie<span class="token punctuation">,</span> <span class="token string">&#39;; &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;=&#39;</span><span class="token punctuation">)</span> <span class="token comment">//\u6CE8\u610F\uFF1A\u62C6\u5206 ; \u65F6\uFF0C\u540E\u9762\u9700\u8981\u52A0\u4E00\u4E2A\u7A7A\u683C</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">//{keywords:&quot;phone&quot;, type:&quot;xiaomi&quot;, id:1001, name:&quot;zs&quot;, ..}</span>

<span class="token comment">// \u6839\u636E\u6D4F\u89C8\u5668\u901A\u8FC7cookie\u53D1\u9001\u8FC7\u6765\u7684\u5173\u952E\u8BCD\uFF0C\u67E5\u8BE2\u6570\u636E\u8868\uFF0C\u8FD4\u56DE\u76F8\u5173\u7684\u6570\u636E</span>
<span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">select * from sp_goods where goods_name like &quot;%phone%&quot;</span><span class="token template-punctuation string">\`</span></span> <span class="token comment">//obj\u4E2D\u5E26phone \u6240\u4EE5\u8981\u67E5\u8BE2phone\u76F8\u5173</span>
db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>fpath<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">list</span><span class="token operator">:</span> result <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_18-3-cookie-\u7684\u6709\u6548\u671F" tabindex="-1"><a class="header-anchor" href="#_18-3-cookie-\u7684\u6709\u6548\u671F" aria-hidden="true">#</a> 18.3 cookie \u7684\u6709\u6548\u671F</h3><ul><li>cookie \u5931\u6548\u7684\u4E24\u79CD\u60C5\u51B5\uFF1A <ul><li>\u8BBE\u7F6E\u4E86 expires \u5219\u6709\u6548\u671F\u5230 expires \u6307\u5B9A\u7684\u65F6\u95F4</li><li>\u672A\u8BBE\u7F6E expires \u5219\u5173\u95ED\u6D4F\u89C8\u5668 cookie \u5373\u6D88\u5931</li></ul></li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/setc&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//\u6CE8\u610F\uFF1A\u8981\u4F7F\u7528UTC\u65F6\u95F4\uFF0C\u4F7F\u7528 toUTCString()\u65B9\u6CD5\u8F6C\u6362</span>
  <span class="token keyword">const</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUTCString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 10s\u540E age\u4ECE\u6D4F\u89C8\u5668\u7AEF\u81EA\u52A8\u5220\u9664</span>
  <span class="token comment">//\u8BBE\u7F6Eage\u65F6\uFF0C\u540C\u65F6\u8BBE\u7F6E\u6709\u6548\u671F,\u6709\u6548\u671F\u8FC7\u540Eage\u4F5C\u5E9F\uFF0C\u5176\u4ED6\u8FD8\u5728</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;set-cookie&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;age=18;expires=&#39;</span> <span class="token operator">+</span> time<span class="token punctuation">,</span> <span class="token string">&#39;name=ifls&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;gender=nu&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;home=shenyang&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_19-session-\u6280\u672F" tabindex="-1"><a class="header-anchor" href="#_19-session-\u6280\u672F" aria-hidden="true">#</a> 19 session \u6280\u672F</h2><p><img src="`+c+`" alt="session"></p><ul><li>\u539F\u7406\uFF1A - \u6D4F\u89C8\u5668\u7B2C\u4E00\u6B21\u8BBF\u95EE\u5E26\u6709 session \u8BBE\u7F6E\u7684\u8DEF\u7531\u65F6\uFF0C\u670D\u52A1\u5668\u4F1A\u81EA\u52A8\u4EA7\u751F\u4E00\u4E2A sessionId\uFF08\u4E00\u4E2A\u5F88\u957F\u7684\u968F\u673A\u5B57\u7B26\u4E32\uFF09\uFF0C\u8BE5 sessionId \u6709\u4E24\u4E2A\u4F5C\u7528 - \u968F\u7740 cookie \u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668\uFF0C\u4FDD\u5B58\u5728\u6D4F\u89C8\u5668\u4E2D \uFF08\u76F8\u5F53\u4E8E\u4E00\u628A\u94A5\u5319\uFF09 - \u5728\u670D\u52A1\u5668\u5F00\u8F9F\u4E00\u5757\u5185\u5B58\u5E76\u4EE5\u8BE5 sessionId \u547D\u540D\uFF0C\u5C06\u6570\u636E\u4FDD\u5B58\u5728\u8BE5\u5185\u5B58\u4E2D \uFF08\u76F8\u5F53\u4E8E\u4E00\u4E2A\u7BB1\u5B50\uFF09 - \u6D4F\u89C8\u5668\u4E4B\u540E\u6BCF\u4E00\u6B21\u8BBF\u95EE\u670D\u52A1\u5668\u65F6\uFF0CsessionId \u90FD\u4F1A\u968F\u7740\u8BF7\u6C42\u5934\u53D1\u9001\u7ED9\u670D\u52A1\u5668\uFF0C\u670D\u52A1\u5668\u5C31\u80FD\u6839\u636E sessionId \u505A\u51FA\u54CD\u5E94\u52A8\u4F5C <h3 id="_19-1-\u8BBE\u7F6E-\u8BFB\u53D6-\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#_19-1-\u8BBE\u7F6E-\u8BFB\u53D6-\u5220\u9664" aria-hidden="true">#</a> 19.1 \u8BBE\u7F6E/\u8BFB\u53D6/\u5220\u9664</h3></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i express-session  \u9700\u8981\u7B2C\u4E09\u65B9\u6A21\u5757
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;running...&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//1) \u52A0\u8F7D express-session \u6A21\u5757</span>
<span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express-session&#39;</span><span class="token punctuation">)</span>
<span class="token comment">//2) \u914D\u7F6E\u9879\uFF0C\u5E76\u5C06\u5176\u6CE8\u518C\u4E3A\u4E2D\u95F4\u4EF6</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">secret</span><span class="token operator">:</span> <span class="token string">&#39;2fh73f1edh47g5d&#39;</span><span class="token punctuation">,</span> <span class="token comment">//\u52A0\u5BC6\u5B57\u7B26\u4E32\u3002 \u4F7F\u7528\u8BE5\u5B57\u7B26\u4E32\u6765\u52A0\u5BC6session\u6570\u636E\uFF0C\u81EA\u5B9A\u4E49</span>
    <span class="token literal-property property">resave</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//\u5F3A\u5236\u4FDD\u5B58session\u5373\u4F7F\u5B83\u5E76\u6CA1\u6709\u53D8\u5316</span>
    <span class="token literal-property property">saveUninitialized</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//\u5F3A\u5236\u5C06\u672A\u521D\u59CB\u5316\u7684session\u5B58\u50A8\u3002\u5F53\u65B0\u5EFA\u4E86\u4E00\u4E2Asession\u4E14</span>
    <span class="token comment">//\u672A\u8BBE\u5B9A\u5C5E\u6027\u6216\u503C\u65F6\uFF0C\u5B83\u5C31\u5904\u4E8E\u672A\u521D\u59CB\u5316\u72B6\u6001\u3002</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment">// session \u8BBE\u7F6E</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/sets&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//\u4F7F\u7528 req.session \u8BBE\u7F6Esession  key=value\u5F62\u5F0F</span>
  req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isLogin <span class="token operator">=</span> <span class="token boolean">true</span>
  req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>userInfo <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;zs&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">pwd</span><span class="token operator">:</span> <span class="token string">&#39;123&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span>
  req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>keywords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;phone&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;tel&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;aaa&#39;</span><span class="token punctuation">]</span>

  <span class="token comment">// \u53EF\u4EE5\u76F4\u63A5\u5199\u503C\uFF1A</span>
  req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;zs&#39;</span>
  req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>pwd <span class="token operator">=</span> <span class="token string">&#39;123&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// session \u83B7\u53D6</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/gets&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>userInfo<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">//zs</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>keywords<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">//tel</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// session \u5220\u9664</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/dels&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  req<span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;destroy-ok&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h3 id="_19-2-session-\u6709\u6548\u671F" tabindex="-1"><a class="header-anchor" href="#_19-2-session-\u6709\u6548\u671F" aria-hidden="true">#</a> 19.2 session \u6709\u6548\u671F</h3><ul><li>\u6D4F\u89C8\u5668\u5173\u95ED\u540E session \u6D88\u5931</li><li>session \u50A8\u5B58\u5728\u670D\u52A1\u5668\u5185\u5B58\u4E2D\uFF0C\u670D\u52A1\u5668\u91CD\u542F session \u4E5F\u6D88\u5931</li></ul><h3 id="_20-\u6848\u4F8B-\u5B66\u751F\u7CFB\u7EDF-\u5B8C\u5584\u767B\u5F55\u529F\u80FD" tabindex="-1"><a class="header-anchor" href="#_20-\u6848\u4F8B-\u5B66\u751F\u7CFB\u7EDF-\u5B8C\u5584\u767B\u5F55\u529F\u80FD" aria-hidden="true">#</a> 20 \u6848\u4F8B:\u5B66\u751F\u7CFB\u7EDF-\u5B8C\u5584\u767B\u5F55\u529F\u80FD</h3><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A app.js</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;stu-server is running&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//\u52A0\u8F7D\u6A21\u677F\u5F15\u64CE</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">&#39;html&#39;</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express-art-template&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// \u52A0\u8F7Dbody-parser\u6A21\u5757</span>
<span class="token keyword">const</span> bodyP <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;body-parser&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u4E2D\u95F4\u4EF6</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  bodyP<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment">// \u52A0\u8F7Dsession\u6A21\u5757</span>
<span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express-session&#39;</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">secret</span><span class="token operator">:</span> <span class="token string">&#39;2384y8sd9yr382&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">resave</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">saveUninitialized</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment">// \u5230\u5904router\u6A21\u5757  \u6CE8\u518C\u4E3A\u4E2D\u95F4\u4EF6</span>
<span class="token keyword">const</span> rt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./router&#39;</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>rt<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>router.js</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u52A0\u8F7Dexpress\u6A21\u5757</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// \u521B\u5EFA\u8DEF\u7531\u5BF9\u8C61</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> moment <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;moment&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./db.js&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// \u6267\u884Csql  \u5B9E\u73B0index.html\u9875\u9762\u663E\u793A</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/login&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// \u5B9A\u4E49sql\u8BED\u53E5</span>
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">select infomation.*,school.schoolName from infomation
     join school on infomation.sdept=school.sid order by sno;</span><span class="token template-punctuation string">\`</span></span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> result<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u589E\u52A0\u6570\u636E\u529F\u80FD\u90E8\u5206</span>

<span class="token comment">//\u83B7\u53D6\u589E\u52A0\u6570\u636E\u9875\u9762</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/add&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/login&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;select * from school&#39;</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;add.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> result<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u63D0\u4EA4\u8868\u5355\u529F\u80FD</span>

<span class="token comment">// post\u65B9\u5F0F\u63D0\u4EA4\u8868\u5355\u6570\u636E</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/addInfo&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// req.body</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">sname</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    <span class="token literal-property property">sgender</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>gender<span class="token punctuation">,</span>
    <span class="token literal-property property">sage</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
    <span class="token literal-property property">stime</span><span class="token operator">:</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&#39;YYYY-MM-DD&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sdept</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>dept<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;insert into infomation set ?&#39;</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> restul</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u5220\u9664\u6570\u636E\u529F\u80FD\u90E8\u5206</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/delstu&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u63A5\u6536get\u63D0\u4EA4\u7684\u503C \u4F5C\u4E3A\u5220\u9664\u7684\u4F9D\u636E</span>
  <span class="token comment">// req.query.sno</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>sno
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;delete from infomation where sno=?&#39;</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//\u7F16\u8F91\u9875\u9762\u529F\u80FD\u90E8\u5206</span>

<span class="token comment">// \u83B7\u53D6\u7F16\u8F91\u9875\u9762\u6570\u636E</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/edit&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/login&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> sno <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>sno
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;select * from infomation where sno=?&#39;</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> sno<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">&#39;select * from school&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err2<span class="token punctuation">,</span> result2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err2<span class="token punctuation">)</span>
      <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">data1</span><span class="token operator">:</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data2</span><span class="token operator">:</span> result2<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
      res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;edit.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u4FEE\u6539\u7F16\u8F91\u9875\u9762\u6570\u636E</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/changeStu&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u63A5\u6536post\u4F20\u6765\u7684\u53C2\u6570</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">sname</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    <span class="token literal-property property">sgender</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>gender<span class="token punctuation">,</span>
    <span class="token literal-property property">sage</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
    <span class="token literal-property property">sdept</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>dept<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// \u63A5\u6536\u5F53\u524D\u70B9\u51FB\u7684\u884C\u6570 \u7528\u4E8E\u6570\u636E\u5E93\u67E5\u8BE2</span>
  <span class="token keyword">const</span> sno <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>no
  <span class="token comment">// \u5B9A\u4E49sql</span>
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;update infomation set ? where sno=?&#39;</span>
  <span class="token comment">// \u6267\u884Csql\u4FEE\u6539\u6570\u636E</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> sno<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/edit?sno=&#39;</span> <span class="token operator">+</span> sno<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u767B\u5F55\u9875\u9762</span>

<span class="token comment">// \u52A0\u8F7D\u767B\u5F55\u754C\u9762</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/login&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;login.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u83B7\u53D6\u6570\u636E\u548C\u6570\u636E\u5E93\u8FDB\u884C\u5BF9\u6BD4</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/loadLogin&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> u <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username
  <span class="token keyword">const</span> psd <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>password
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;select * from user where user=? and password=?&#39;</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">[</span>u<span class="token punctuation">,</span> psd<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token operator">||</span> result<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/login&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u7528session\u5B9A\u4E49true \u5982\u679C\u767B\u5F55\u4E86 isLogin\u5C31\u662Ftrue \u6CA1\u767B\u5F55\u5C31\u662Ffalse</span>
      <span class="token comment">// \u7528\u4EE5If\u6765\u5224\u65AD</span>
      req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>isLogin <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token comment">// \u63A5\u6536\u767B\u5F55\u4FE1\u606F\uFF08\u6B64\u5904\u65E0\u7528\uFF09</span>
      req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>userInfo <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
      res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u5230\u5904router\u6A21\u5757</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br></div></div><h2 id="_20-\u4E2D\u95F4\u4EF6" tabindex="-1"><a class="header-anchor" href="#_20-\u4E2D\u95F4\u4EF6" aria-hidden="true">#</a> 20 \u4E2D\u95F4\u4EF6</h2><p>\u4E2D\u95F4\u4EF6\uFF1Aexpress \u4E2D\u95F4\u4EF6\u662F\u4E00\u4E2A\u7279\u6B8A\u7684 url \u5730\u5740\u5904\u7406\u51FD\u6570</p><ul><li>\u8BE5\u51FD\u6570\u4E2D\u6709\u4E09\u4E2A\u57FA\u672C\u53C2\u6570\uFF0C req\u3001res\u3001next <ul><li>req \u5C31\u662F\u56DE\u8C03\u51FD\u6570\u4E2D\u7684 req \u5BF9\u8C61</li><li>res \u5C31\u662F\u56DE\u8C03\u51FD\u6570\u4E2D\u7684 res \u5BF9\u8C61</li><li>next\uFF1A\u5F53\u8BE5\u4E2D\u95F4\u4EF6\u6267\u884C\u5B8C\u6210\u540E\u81EA\u52A8\u8FDB\u5165\u4E0B\u4E00\u4E2A\u4E2D\u95F4\u4EF6</li></ul></li></ul><h3 id="_20-1-\u81EA\u5B9A\u4E49\u4E2D\u95F4\u4EF6" tabindex="-1"><a class="header-anchor" href="#_20-1-\u81EA\u5B9A\u4E49\u4E2D\u95F4\u4EF6" aria-hidden="true">#</a> 20.1 \u81EA\u5B9A\u4E49\u4E2D\u95F4\u4EF6</h3><p>\u6848\u4F8B\uFF1A\u8981\u6C42 1\uFF1A\u5236\u4F5C\u8BB0\u5F55\u65E5\u5FD7\u7684\u4E2D\u95F4\u4EF6 \u8981\u6C42 2\uFF1A\u81EA\u5B9A\u4E49 url \u68C0\u6D4B\u4E2D\u95F4\u4EF6\uFF0C\u4E0D\u5B58\u5728\u7684 url \u5730\u5740\u76F4\u63A5\u663E\u793A 404</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u8C03\u7528\u4E2D\u95F4\u4EF6</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>checkUrl<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>writeLog<span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;middle-server is running...&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;index-OK&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/list&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;list-OK&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/add&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;add-OK&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u8BBE\u7F6E\u4E2D\u95F4\u4EF6</span>
<span class="token keyword">function</span> <span class="token function">writeLog</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> str <span class="token operator">=</span> req<span class="token punctuation">.</span>url <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;\\n&#39;</span>
  fs<span class="token punctuation">.</span><span class="token function">appendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;run.log&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">checkUrl</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>url <span class="token operator">==</span> <span class="token string">&#39;/index&#39;</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>url <span class="token operator">==</span> <span class="token string">&#39;/list&#39;</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>url <span class="token operator">==</span> <span class="token string">&#39;/add&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;404 not found&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><blockquote><p>\u6CE8\u518C\u987A\u5E8F\u9700\u8981\u8C28\u614E\uFF0C\u5148\u6CE8\u518C\u54EA\u4E2A\u4E2D\u95F4\u4EF6\u5C31\u4F1A\u5148\u6267\u884C\u54EA\u4E2A\u4E2D\u95F4\u4EF6</p></blockquote><p>\u6848\u4F8B\u4E2D\u95F4\u4EF6\u56FE\u89E3\uFF1A <img src="`+l+`" alt=""></p><h3 id="_20-2-\u6848\u4F8B-\u68C0\u6D4B\u767B\u5F55\u72B6\u6001\u4E2D\u95F4\u4EF6" tabindex="-1"><a class="header-anchor" href="#_20-2-\u6848\u4F8B-\u68C0\u6D4B\u767B\u5F55\u72B6\u6001\u4E2D\u95F4\u4EF6" aria-hidden="true">#</a> 20.2 \u6848\u4F8B\uFF1A\u68C0\u6D4B\u767B\u5F55\u72B6\u6001\u4E2D\u95F4\u4EF6</h3><p>\u65B9\u6CD5\uFF1A\u5728\u6BCF\u4E2A\u8DEF\u7531\u4E2D\u90FD\u8981\u68C0\u6D4B isLogin \u7684\u72B6\u6001\uFF0C\u9664\u4E86 /login \u548C /checkLogin</p><h3 id="_20-3-\u4E2D\u95F4\u4EF6\u7C7B\u522B" tabindex="-1"><a class="header-anchor" href="#_20-3-\u4E2D\u95F4\u4EF6\u7C7B\u522B" aria-hidden="true">#</a> 20.3 \u4E2D\u95F4\u4EF6\u7C7B\u522B</h3><ul><li><p>express \u6709\u4E94\u79CD\u7C7B\u522B\u7684\u4E2D\u95F4\u4EF6(\u4E86\u89E3\u5373\u53EF)\uFF1A</p><ul><li>\u5E94\u7528\u7EA7\u522B\u7684\u4E2D\u95F4\u4EF6\uFF1A \u6302\u8F7D\u5230 app \u4E0A\u7684\u4E2D\u95F4\u4EF6\uFF0C\u4F8B\u5982\uFF1Aapp.use()</li><li>\u8DEF\u7531\u7EA7\u522B\u7684\u4E2D\u95F4\u4EF6\uFF1A \u6302\u8F7D\u5230 router \u5BF9\u8C61\u4E0A\u7684\u4E2D\u95F4\u4EF6\uFF0C\u4F8B\u5982\uFF1Arouter.get()\u3001 router.post</li><li>\u9519\u8BEF\u7EA7\u522B\u7684\u4E2D\u95F4\u4EF6\uFF1A \u56DE\u8C03\u51FD\u6570\u4E2D\uFF0C\u6709\u56DB\u4E2A\u53C2\u6570 app.use((err, req, res, next)=&gt;{})</li><li>\u5185\u7F6E\u4E2D\u95F4\u4EF6\uFF1A express.static() \uFF0C express \u63D0\u4F9B\u7684\u552F\u4E00\u5185\u7F6E\u4E2D\u95F4\u4EF6</li><li>\u7B2C\u4E09\u65B9\u4E2D\u95F4\u4EF6\uFF1A \u975E express \u6846\u67B6\u63D0\u4F9B\u7684\uFF0C\u9700\u8981\u7A0B\u5E8F\u5458\u624B\u52A8\u5B89\u88C5\u624D\u80FD\u4F7F\u7528\u7684\u4E2D\u95F4\u4EF6\uFF1Bbody-parser \u89E3\u6790 post \u8868\u5355\u6570\u636E</li></ul></li></ul><h2 id="_21-\u524D\u540E\u7AEF\u6574\u7684-ajax-\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#_21-\u524D\u540E\u7AEF\u6574\u7684-ajax-\u6D41\u7A0B" aria-hidden="true">#</a> 21 \u524D\u540E\u7AEF\u6574\u7684 ajax \u6D41\u7A0B</h2><p>\u6848\u4F8B\uFF1A\u4E0B\u62C9\u5217\u8868\u6848\u4F8B \u540E\u7AEF\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;goods-server has been active on 3000&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u52A0\u8F7Dmysql\u6A21\u5757</span>
<span class="token keyword">const</span> mysql <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mysql&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u521B\u5EFAmysql\u5BF9\u8C61\u5E76\u914D\u7F6E</span>
<span class="token keyword">const</span> conn <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&#39;127.0.0.1&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token string">&#39;goods&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// \u521B\u5EFA\u94FE\u63A5</span>
conn<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// \u52A0\u8F7D\u6A21\u677F\u5F15\u64CE</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">&#39;html&#39;</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express-art-template&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">//\u9759\u6001\u8D44\u6E90\u6258\u7BA1</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/images&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;images&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/js&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/style&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;style&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/Uploads&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Uploads&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// \u6E32\u67D3\u9875\u9762</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./db.js&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// \u76D1\u542Cajax\u8BF7\u6C42\u5730\u5740</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/getData&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u63A5\u6536ajax\u8BF7\u6C42\u6570\u636E</span>
  <span class="token keyword">const</span> inputVal <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>val
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>inputVal<span class="token punctuation">)</span>
  <span class="token comment">// \u5B9A\u4E49\u6A21\u7CCA\u67E5\u8BE2</span>
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">select * from goods_key where key_name like &#39;%</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>inputVal<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%&#39;</span><span class="token template-punctuation string">\`</span></span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&#39;\u6570\u636E\u8BF7\u6C42\u6210\u529F&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">msg</span><span class="token operator">:</span> result<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.txt&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u83B7\u53D6\u5F53\u524Dinput\u6846\u4E2D\u7684val\u503C  \u7528\u6765\u53D1\u9001ajax\u8BF7\u6C42</span>
  <span class="token keyword">var</span> inputVal <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// \u89E3\u51B3bug\uFF1A\u8F93\u5165\u7A7A\u683C\u7684\u65F6\u5019\u4E5F\u4F1A\u53D1\u9001ajax\u8BF7\u6C42\uFF0C\u7528trim\u65B9\u6CD5\u80FD\u53BB\u9664\u5B57\u7B26\u4E32\u7684\u7A7A\u683C</span>
  inputVal <span class="token operator">=</span> inputVal<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// \u89E3\u51B3bug: \u5F53\u8F93\u5165\u6846\u4E3A\u7A7A\u7684\u65F6\u5019\uFF0C\u4E5F\u4F1A\u663E\u793A\u5185\u5BB9\uFF1A\u5224\u65ADinputVal\u7684\u957F\u5EA6\uFF0C\u5982\u679C\u957F\u5EA6\u7B49\u4E8E0\u7684\u8BDD\u5C31\u662F\u6CA1\u8F93\u5165\u5185\u5BB9</span>
  <span class="token comment">// \u7136\u540E\u5C31\u505C\u6B62\u4E0B\u9762\u53D1\u9001ajax\u8BF7\u6C42\u7684\u4EE3\u7801</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>inputVal<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.addbox&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/getData&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">dataType</span><span class="token operator">:</span> <span class="token string">&#39;json&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">val</span><span class="token operator">:</span> inputVal<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u6BCF\u6B21\u5411\u76D2\u5B50\u8FFD\u52A0\u5185\u5BB9\u4E4B\u524D\u6E05\u7A7A\u539F\u6709\u7684\u5185\u5BB9</span>
      <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.addbox&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

      <span class="token comment">// data.msg\u662F\u540E\u7AEF\u8FD4\u56DE\u7ED9\u524D\u7AEF\u7684\u6570\u636E \u662F\u6570\u7EC4\u5F62\u5F0F\u7684 [].forEach\u662F\u5FAA\u73AF\u6570\u7EC4</span>
      <span class="token comment">// item \u662F\u5355\u5143\u7684\u503C  index\u662F\u4E0B\u6807</span>

      data<span class="token punctuation">.</span>msg<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u5F53\u62FF\u5230\u6570\u636E\u7684\u65F6\u5019\u663E\u793A\u76D2\u5B50</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.addbox&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">// \u5C06\u4ECE\u540E\u7AEF\u63A5\u6536\u7684\u6570\u636E\u52A8\u6001\u6E32\u67D3\u5230\u9875\u9762\u4E2D</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&lt;div class=&quot;goodInfo&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>key_name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendTo</span><span class="token punctuation">(</span><span class="token string">&#39;.addbox&#39;</span><span class="token punctuation">)</span>

        <span class="token comment">// \u5B9E\u73B0\u9F20\u6807\u79FB\u5165\u9009\u9879\u989C\u8272\u53D8\u7EA2</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.goodInfo&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mouseenter</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&#39;red&#39;</span><span class="token punctuation">,</span>
              <span class="token literal-property property">cursor</span><span class="token operator">:</span> <span class="token string">&#39;default&#39;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">siblings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;color&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token comment">// \u5B9E\u73B0\u70B9\u51FB\u9009\u9879\u5185\u5BB9\u8FDB\u5165input\u6846\u4E2D</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.goodInfo&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.txt&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.addbox&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//\u5B9E\u73B0\u70B9\u51FB\u9009\u9879\u540E\u9690\u85CF\u76D2\u5B50</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h2 id="_22-ajax-\u8DE8\u57DF" tabindex="-1"><a class="header-anchor" href="#_22-ajax-\u8DE8\u57DF" aria-hidden="true">#</a> 22 Ajax \u8DE8\u57DF</h2><blockquote><p>\u7B80\u5355\u6765\u8BF4\uFF0C\u5C31\u662F\u7F51\u7AD9 A \u53BB\u8C03\u7528\u7F51\u7AD9 B \u7684\u6570\u636E\uFF0C\u4F46\u662F\u6D4F\u89C8\u5668\u7684\u540C\u6E90\u7B56\u7565\uFF08\u4E3A\u4E86\u5B89\u5168\uFF09\u4F1A\u5F71\u54CD\u8DE8\u57DF\u8BF7\u6C42</p></blockquote><p>\u8DE8\u57DF\u95EE\u9898\uFF1AA \u670D\u52A1\u5668\u663E\u793A index.html \u9875\u9762\uFF0C\u5728 index.html \u9875\u9762\u4E2D\u5411 B \u670D\u52A1\u5668\u53D1\u9001 Ajax \u8BF7\u6C42\uFF0C\u6B64\u65F6 B \u670D\u52A1\u5668\u867D\u7136\u6709\u54CD\u5E94\uFF0C\u4F46\u662F\u4F1A\u88AB\u6D4F\u89C8\u5668\u963B\u6B62\u3002</p><h3 id="_22-1-cors-\u8DE8\u57DF" tabindex="-1"><a class="header-anchor" href="#_22-1-cors-\u8DE8\u57DF" aria-hidden="true">#</a> 22.1 cors \u8DE8\u57DF</h3><p>\u8981\u7528\u5230\u7B2C\u4E09\u65B9\u6A21\u5757 npn i cors \u7F51\u7AD9 A \u8BF7\u6C42\u7F51\u7AD9 B \u7684\u6570\u636E\uFF0C cors \u662F\u5199\u5728\u7F51\u7AD9 B \u4E2D\u7684</p><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A</p><p>app1.js</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;server A is running&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/node_modules&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">&#39;../node_modules&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>app2.js</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;server B is running&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//\u52A0\u8F7Dcors\u6A21\u5757</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;cors&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u6CE8\u518Ccors\u6A21\u5757\u4E3A\u4E2D\u95F4\u4EF6</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// \u82E5\u6CA1cors \u90A3\u4E48index.html\u65E0\u6CD5\u83B7\u53D6\u5230app2\u670D\u52A1\u5668\u4E2D\u7684\u6570\u636E</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/getData&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token string">&#39;code is ok&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">&#39;this is a lot of data&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>\u5728 html \u9875\u9762\u53D1\u9001 ajax \u8BF7\u6C42</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;http://127.0.0.1:4000/getData&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dataType</span><span class="token operator">:</span> <span class="token string">&#39;json&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_22-2-jsonp-\u8DE8\u57DF" tabindex="-1"><a class="header-anchor" href="#_22-2-jsonp-\u8DE8\u57DF" aria-hidden="true">#</a> 22.2 jsonp \u8DE8\u57DF</h3><blockquote><p>\u6D4F\u89C8\u5668\u867D\u7136\u6709\u540C\u6E90\u7B56\u7565\uFF0C\u4F46\u662F src \u548C href \u4E24\u4E2A\u5C5E\u6027\u5374\u53EF\u4EE5\u8DE8\u57DF\u8BBF\u95EE\u3002 \u53EF\u4EE5\u5229\u7528\u8FD9\u4E00\u201C\u6F0F\u6D1E\u201D\u6765\u8BF7\u6C42\u53E6\u4E00\u4E2A\u7F51\u7AD9\u7684\u9875\u9762\u3002</p></blockquote><p>\u6B64\u4E3A\u6F14\u793A\uFF0C\u5E76\u6CA1\u6709\u7528\u5230 ajax</p><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A app1.js</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;app1 is running&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>app2.js</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;app2 is running&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/getData&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//send\u53D1\u9001\u7684\u5B57\u7B26\u4E32\uFF0C\u4EE5\u51FD\u6570fn({})\u5F62\u5F0F\u53D1\u9001\u7ED9index\u9875\u9762\uFF0C\u7ECF\u8FC7\u9875\u9762\u7684\u51FD\u6570\u8C03\u7528\u4ECE\u800C\u62FF\u5230\u5BF9\u8C61\u7684\u503C</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&#39;fn({code:&quot;ni zl gj uf me&quot;,mgs:&quot;wo ye bu zi dk&quot;})&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>index \u9875\u9762\uFF1A</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- \u77E5\u8BC6\u70B9\uFF1A\u56E0\u4E3A\u540E\u7AEF/getData\u8FD4\u56DE\u4E86\u4E00\u4E2Aaaa\uFF1B\u76F8\u5F53\u4E8E\u524D\u7AEFscript\u6807\u7B7E\u8BF7\u6C42\u5F97\u5230\u7684\u7ED3\u679C\u5C31\u662Faaa\uFF1B\u6B64\u65F6aaa\u88AB\u8BA4\u4E3A\u6210\u4E00\u4E2A\u53D8\u91CF\uFF0C\u6240\u4EE5\u624D\u8981\u7528\u51FD\u6570\u7684\u5F62\u53C2\u63A5\u6536 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>jsonp\u65B9\u6CD5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">// \u6CE8\u610F: \u6B64\u5904\u5E94\u8BE5\u5148\u5B9A\u4E49\u51FD\u6570 \u540E\u8C03\u7528 \u4E0D\u7136\u4F1A\u627E\u4E0D\u5230fn\u51FD\u6570</span>
    <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">agr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>agr<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://127.0.0.1:4000/getData<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_22-3-ajax-\u7684-jsonp-\u8DE8\u57DF\u8BF7\u6C42" tabindex="-1"><a class="header-anchor" href="#_22-3-ajax-\u7684-jsonp-\u8DE8\u57DF\u8BF7\u6C42" aria-hidden="true">#</a> 22.3 ajax \u7684 jsonp \u8DE8\u57DF\u8BF7\u6C42</h3><blockquote><p>\u6CE8\u610F\uFF1A $.post $.get $.ajax\u90FD\u80FD\u53D1\u9001\u8DE8\u57DF\u8BF7\u6C42\u3002\u4F46\u662F\uFF0C$.post \u548C$.get\u662F\u8981\u4F9D\u9760cors\u65B9\u5F0F\u7684\uFF0C\u53EA\u6709$.ajax \u80FD\u4F7F\u7528 jsonp \u65B9\u5F0F</p></blockquote><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A</p><p>\u670D\u52A1\u5668\u6E32\u67D3\u9875\u9762\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;sevser A has been active&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/node_modules&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">&#39;../node_modules&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>\u9875\u9762\u53D1\u9001\u8BF7\u6C42\uFF1A</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>ajax\u901A\u8FC7jsonp\u65B9\u5F0F\u53D1\u9001\u8DE8\u57DF\u8BF7\u6C42<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../node_modules/jquery/dist/jquery.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;http://127.0.0.1:4000/getData&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">dataType</span><span class="token operator">:</span> <span class="token string">&#39;jsonp&#39;</span><span class="token punctuation">,</span> <span class="token comment">//\u8981\u6C42\u670D\u52A1\u5668\u8FD4\u56DE\u7684\u683C\u5F0F\u662Fjsonp</span>
      <span class="token literal-property property">jsonp</span><span class="token operator">:</span> <span class="token string">&#39;callback&#39;</span><span class="token punctuation">,</span> <span class="token comment">//\u5B9A\u4E49jsonp\u540D\u79F0\uFF0C\u7EA6\u5B9A\u4FD7\u6210\u4E3Acallback</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token comment">//\u6CE8\u610F\uFF1A\u63A5\u6536\u56DE\u6765\u7684\u6570\u636E\u662F\u4E00\u4E2A\u5BF9\u8C61\u5F62\u5F0F</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.box&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>\u670D\u52A1\u5668 2 \u54CD\u5E94\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;sevser B has been active&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/getData&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u63A5\u6536ajax\u8BF7\u6C42\u7684\u6570\u636E</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>callback

  <span class="token comment">// jsop\u5B9E\u73B0\u601D\u8DEF\uFF1A\u901A\u8FC7ajax\u53D1\u9001callback\u6570\u636E\uFF0C\u670D\u52A1\u56682\u63A5\u6536callback\u6570\u636E \u7136\u540E\u62FC\u63A5\u4E0A\u8981\u8FD4\u8FD8\u7ED9\u9875\u9762\u7684\u6570\u636E\u8FD4\u8FD8\u7ED9\u9875\u9762</span>

  <span class="token comment">//\u5C06\u63A5\u6536\u7684\u6570\u636E\u548C\u8981\u8FD4\u8FD8\u7ED9\u524D\u7AEF\u7684\u6570\u636E\u62FC\u63A5\u5728\u4E00\u8D77  \u6CE8\u610F+\u53F7\u540E\u9762\u7684\u5199\u6CD5&#39;({})&#39;</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>data <span class="token operator">+</span> <span class="token string">&#39;({a:&quot;hello,silly jsonp&quot;, b:&quot;world&quot;})&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>\u5929\u6C14\u6848\u4F8B\uFF1A \u670D\u52A1\u5668 1</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;server is running&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/node_modules&#39;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">&#39;../node_modules&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/index&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>\u9875\u9762\uFF1A</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>\u57CE\u5E02<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>30\xB0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>\u98CE\u529B<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../node_modules/jquery/dist/jquery.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../node_modules/art-template/lib/template-web.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/html<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tmp<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>city<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>tem<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>wind<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;http://127.0.0.1:4000/getData&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">dataType</span><span class="token operator">:</span> <span class="token string">&#39;jsonp&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">jsop</span><span class="token operator">:</span> <span class="token string">&#39;callback&#39;</span><span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
          <span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token function">template</span><span class="token punctuation">(</span><span class="token string">&#39;tmp&#39;</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span>
          <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;tbody&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>\u670D\u52A1\u5668 2\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;sevser B has been active&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/getData&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u63A5\u6536ajax\u8BF7\u6C42\u7684\u6570\u636E</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>callback

  <span class="token comment">// jsop\u5B9E\u73B0\u601D\u8DEF\uFF1A\u901A\u8FC7ajax\u53D1\u9001callback\u6570\u636E\uFF0C\u670D\u52A1\u56682\u63A5\u6536callback\u6570\u636E \u7136\u540E\u62FC\u63A5\u4E0A\u8981\u8FD4\u8FD8\u7ED9\u9875\u9762\u7684\u6570\u636E\u8FD4\u8FD8\u7ED9\u9875\u9762</span>

  <span class="token comment">//\u5C06\u63A5\u6536\u7684\u6570\u636E\u548C\u8981\u8FD4\u8FD8\u7ED9\u524D\u7AEF\u7684\u6570\u636E\u62FC\u63A5\u5728\u4E00\u8D77  \u6CE8\u610F+\u53F7\u540E\u9762\u7684\u5199\u6CD5&#39;({})&#39;</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>data <span class="token operator">+</span> <span class="token string">&#39;({city:&quot;\u5317\u4EAC&quot;,tem:&quot;30\xB0&quot;,wind:&quot;bigwind&quot;})&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_22-4-\u8BF7\u6C42\u5934\u914D\u7F6E\u8DE8\u57DF" tabindex="-1"><a class="header-anchor" href="#_22-4-\u8BF7\u6C42\u5934\u914D\u7F6E\u8DE8\u57DF" aria-hidden="true">#</a> 22.4 \u8BF7\u6C42\u5934\u914D\u7F6E\u8DE8\u57DF</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Origin&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span>
    <span class="token string">&#39;Access-Control-Allow-Headers&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;Authorization,X-API-KEY, Origin, X-Requested-With, Content-Type, Accept, Access-Control-Request-Method&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Methods&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;GET, POST, OPTIONS, PATCH, PUT, DELETE&#39;</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Allow&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;GET, POST, PATCH, OPTIONS, PUT, DELETE&#39;</span><span class="token punctuation">)</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_23-mvc-\u5F00\u53D1\u6A21\u5F0F" tabindex="-1"><a class="header-anchor" href="#_23-mvc-\u5F00\u53D1\u6A21\u5F0F" aria-hidden="true">#</a> 23 MVC \u5F00\u53D1\u6A21\u5F0F</h2><p>\u963F\u91CC\u767E\u79C0\u9879\u76EE\u4E2D\u6709\u4EE3\u7801</p><h3 id="_23-1-\u4EC0\u4E48\u662F-mvc-\u5F00\u53D1\u6A21\u5F0F" tabindex="-1"><a class="header-anchor" href="#_23-1-\u4EC0\u4E48\u662F-mvc-\u5F00\u53D1\u6A21\u5F0F" aria-hidden="true">#</a> 23.1 \u4EC0\u4E48\u662F MVC \u5F00\u53D1\u6A21\u5F0F</h3><p>MVC \u5F00\u53D1\u6A21\u5F0F\u662F\u73B0\u5728\u6700\u5E38\u7528\u7684\u4E00\u79CD\u5F00\u53D1\u6A21\u5F0F\uFF08\u4E5F\u53EF\u4EE5\u53EB\u8F6F\u4EF6\u67B6\u6784\uFF09\u3002\u5C06\u4E00\u4E2A\u5E94\u7528\u7A0B\u5E8F\u5206\u6210\u4E86\u4E09\u4E2A\u90E8\u5206</p><ul><li>M\uFF08model\uFF09\u6A21\u578B\uFF1A \u4E00\u822C\u662F\u6307\u6570\u636E\u8868\u6A21\u578B\uFF0C\u4E13\u95E8\u8FDB\u884C\u6570\u636E\u8868\u7684\u589E\u5220\u6539\u67E5\u64CD\u4F5C</li><li>V\uFF08view\uFF09\u89C6\u56FE\uFF1A \u5C31\u662F\u5448\u73B0\u7ED9\u6700\u7EC8\u7528\u6237\u6D4F\u89C8\u7684 html \u6587\u4EF6\uFF0C\u4E00\u822C\u662F\u524D\u7AEF\u7A0B\u5E8F\u5458\u5F00\u53D1</li><li>C\uFF08controller\uFF09\u63A7\u5236\u5668\uFF1A \u63A7\u5236\u7A0B\u5E8F\u6267\u884C\u6D41\u7A0B\uFF08\u52A0\u8F7D\u54EA\u4E2A\u6A21\u578B\uFF0C\u663E\u793A\u54EA\u4E2A\u9875\u9762\uFF09</li></ul><p>\u5B9E\u73B0\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u52A0\u8F7D\u6A21\u5757</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../db&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> <span class="token function-variable function">index</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>rootPath<span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;admin&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;cate&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;cate.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// cate\u9996\u9875\u52A0\u8F7D\u5217\u8868\u8BF7\u6C42</span>
<span class="token keyword">let</span> <span class="token function-variable function">cate_ask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u5B9A\u4E49sql\u8BED\u53E5</span>
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">&#39;select * from ali_cate&#39;</span>
  <span class="token comment">// \u6267\u884Csql\u8BED\u53E5</span>
  db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token operator">||</span> result<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">201</span><span class="token punctuation">,</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&#39;\u6570\u636E\u8BF7\u6C42\u5931\u8D25&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token literal-property property">data</span><span class="token operator">:</span> result <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// \u5BFC\u51FA\u4E3A\u6A21\u5757</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  index<span class="token punctuation">,</span>
  cate_ask<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>\u8DEF\u7531\u76D1\u542C\u9875\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u52A0\u8F7Dcontroller_cate\u6A21\u5757</span>
<span class="token keyword">const</span> c_cate <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../controller/controller_cate&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// cate\u9996\u9875\u8DEF\u7531            \u4F7F\u7528\u6A21\u5757\u660E.\u65B9\u6CD5\u7684\u64CD\u4F5C</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/admin/cate/cate&#39;</span><span class="token punctuation">,</span> c_cate<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
<span class="token comment">// cate\u9996\u9875\u52A0\u8F7D\u5217\u8868\u8BF7\u6C42</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/getCate&#39;</span><span class="token punctuation">,</span> c_cate<span class="token punctuation">.</span>cate_ask<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_24-promise" tabindex="-1"><a class="header-anchor" href="#_24-promise" aria-hidden="true">#</a> 24 Promise</h2><h3 id="_24-1-\u56DE\u8C03\u5730\u72F1" tabindex="-1"><a class="header-anchor" href="#_24-1-\u56DE\u8C03\u5730\u72F1" aria-hidden="true">#</a> 24.1 \u56DE\u8C03\u5730\u72F1</h3><p>\u56DE\u8C03\u51FD\u6570\u5199\u591A\u4E86\u4EE3\u7801\u770B\u7740\u6076\u5FC3</p><h3 id="_24-2-promise-\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#_24-2-promise-\u6982\u8FF0" aria-hidden="true">#</a> 24.2 Promise \u6982\u8FF0</h3><p>Promise \u672C\u8EAB\u4E0D\u662F\u5F02\u6B65\u7684\uFF0C\u4F46\u662F\u5176\u5185\u90E8\u7684\u6267\u884C\u7A0B\u5E8F\u662F\u5F02\u6B65\u7684</p><ul><li>Promise \u662F\u4E00\u4E2A\u6784\u9020\u51FD\u6570\uFF0C\u53EF\u4EE5 new \u64CD\u4F5C\u5F97\u5230\u4E00\u4E2A\u5B9E\u4F8B\u5BF9\u8C61</li><li>Promise \u5BF9\u8C61\u4E2D\u5305\u542B reject \u548C resolve \u4E24\u4E2A\u65B9\u6CD5 <ul><li>reject\uFF1A \u5931\u8D25\u65F6\u7684\u56DE\u8C03\u51FD\u6570</li><li>resolve\uFF1A\u6210\u529F\u65F6\u7684\u56DE\u8C03\u51FD\u6570</li></ul></li></ul><p>\u4EE3\u7801\u8BE6\u89E3\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// Promise\u662F\u4E00\u4E2A\u6784\u9020\u51FD\u6570\uFF0C\u53EF\u4EE5new \u4E00\u4E2A\u5BF9\u8C61</span>
<span class="token comment">// Promise\u7684\u56DE\u8C03\u51FD\u6570\u53C2\u6570\u4E2D\u6709\u4E24\u4E2A\u53C2\u6570  resolve \u548C reject</span>
<span class="token comment">// resolve\u5C31\u662F\u6210\u529F\u7684\u56DE\u8C03\u51FD\u6570</span>
<span class="token comment">// reject\u5C31\u662F\u5931\u8D25\u7684\u56DE\u8C03\u51FD\u6570</span>
<span class="token comment">// Promise\u5BF9\u8C61\u4E2D\u6709\u4E00\u4E2Athen\u65B9\u6CD5\uFF0C\u8BE5\u65B9\u6CD5\u80FD\u591F\u63A5\u6536\u5230\u6210\u529F(resolve)\u548C\u5931\u8D25(reject)\u7684\u56DE\u8C03\u51FD\u6570</span>
<span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">&#39;../async/1.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token comment">//\u5931\u8D25\u7684\u56DE\u8C03\u51FD\u6570\u80FD\u591F\u88ABthen\u65B9\u6CD5\u7684\u53C2\u65702\u63A5\u6536\u5230</span>
    <span class="token punctuation">}</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token comment">//\u6210\u529F\u7684\u56DE\u8C03\u51FD\u6570\u80FD\u591F\u88ABthen\u65B9\u6CD5\u7684\u53C2\u65701\u63A5\u6536\u5230</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//p\u5BF9\u8C61(Promise)\u7684then\u65B9\u6CD5\u80FD\u591F\u63A5\u6536\u5230Promise\u5185\u90E8\u5F02\u6B65\u64CD\u4F5C\u7ED3\u679C</span>
<span class="token comment">//then\u5BF9\u5E94resolve\u51FD\u6570</span>
<span class="token comment">//catch\u5BF9\u5E94 reject \u51FD\u6570</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_24-3-promise-\u8BFB\u53D6\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_24-3-promise-\u8BFB\u53D6\u6587\u4EF6" aria-hidden="true">#</a> 24.3 Promise \u8BFB\u53D6\u6587\u4EF6</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5B9A\u4E49Promise\u51FD\u6570</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">pReadFile</span><span class="token punctuation">(</span><span class="token parameter">fPath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>fPath<span class="token punctuation">,</span> <span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token comment">//\u5931\u8D25\u7684\u56DE\u8C03\u51FD\u6570\u80FD\u591F\u88ABthen\u65B9\u6CD5\u7684\u53C2\u65702\u63A5\u6536\u5230</span>
      <span class="token punctuation">}</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token comment">//\u6210\u529F\u7684\u56DE\u8C03\u51FD\u6570\u80FD\u591F\u88ABthen\u65B9\u6CD5\u7684\u53C2\u65701\u63A5\u6536\u5230</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">//\u5C06new\u51FA\u6765\u7684 Promise \u5BF9\u8C61\u8FD4\u56DE</span>
  <span class="token keyword">return</span> p
<span class="token punctuation">}</span>

<span class="token comment">// \u94FE\u5F0F\u8C03\u7528</span>
<span class="token function">pReadFile</span><span class="token punctuation">(</span><span class="token string">&#39;../async/1.txt&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">pReadFile</span><span class="token punctuation">(</span><span class="token string">&#39;../async/2.txt&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">pReadFile</span><span class="token punctuation">(</span><span class="token string">&#39;../async/3.txt&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="_24-4-promise-\u5C01\u88C5-mysql-\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_24-4-promise-\u5C01\u88C5-mysql-\u64CD\u4F5C" aria-hidden="true">#</a> 24.4 Promise \u5C01\u88C5 MySQL \u64CD\u4F5C</h3><p>\u5B9E\u73B0\u4EE3\u7801</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5C01\u88C5\u90E8\u5206</span>
<span class="token keyword">const</span> mysql <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mysql&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> conn <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&#39;127.0.0.1&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token string">&#39;alishow&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

conn<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token parameter">sql<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    conn<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> args<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        conn<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      conn<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> query
<span class="token comment">// \u8C03\u7528\u90E8\u5206  //\u901A\u5E38\u62C6\u5206\u4E3A\u4E24\u4E2A\u6587\u4EF6</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./mysql.js&#39;</span><span class="token punctuation">)</span>

<span class="token function">db</span><span class="token punctuation">(</span><span class="token string">&#39;select * from ali_cate where cate_id=?&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h3 id="_24-5-await-\u548C-async-\u5173\u952E\u8BCD" tabindex="-1"><a class="header-anchor" href="#_24-5-await-\u548C-async-\u5173\u952E\u8BCD" aria-hidden="true">#</a> 24.5 await \u548C async \u5173\u952E\u8BCD</h3><p>Promise \u7684 then \u65B9\u6CD5\u548C catch \u65B9\u6CD5\u4F9D\u7136\u6709\u70B9\u5947\u602A\uFF0C\u56E0\u4E3A\u901A\u5E38\u6765\u8BB2\u4E00\u4E2A\u51FD\u6570\u90FD\u4F1A\u4F7F\u7528 return \u8FD4\u56DE\u4E00\u4E2A\u6570\u636E\uFF0C \u8C03\u7528\u8BE5\u51FD\u6570\u540E\u53EF\u4EE5\u4F7F\u7528\u4E00\u4E2A\u53D8\u91CF\u6765\u63A5\u6536\u8FD4\u56DE\u503C\u3002await \u548C async \u5173\u952E\u8BCD\u80FD\u591F\u5E2E\u52A9\u6211\u4EEC\u5B9E\u73B0\u8BE5\u6A21\u5F0F\u3002 \u540C\u65F6\u8BE5\u65B9\u5F0F\u8FD8\u80FD\u8BA9\u6211\u4EEC\u4F7F\u7528\u5F02\u6B65\u8C03\u7528\u7684\u65B9\u6CD5\uFF0C\u6309\u7167\u540C\u6B65\u65B9\u5F0F\u653E\u56DE\u6570\u636E\u3002</p><ul><li>await \u548C async \u662F es7 \u6269\u5C55\u51FA\u7684\u5173\u952E\u8BCD\uFF0C\u529F\u80FD\u63A5\u6536 Promise \u4E2D resolve \u6216\u8005 reject \u7684\u8FD4\u56DE\u503C</li><li>async \u7528\u6765\u4FEE\u9970\u6709 Promise \u8FD4\u56DE\u503C\u7684\u51FD\u6570</li><li>await \u7528\u6765\u4FEE\u9970\u8C03\u7528 Promise \u8FD4\u56DE\u503C\u7684\u51FD\u6570</li></ul><p>\u6848\u4F8B 1</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//\u987A\u5E8F\u8BFB\u53D6a.txt, b.txt, c.txt \u4E09\u4E2A\u6587\u4EF6</span>
<span class="token comment">//\u5982\u679C\u5728\u51FD\u6570\u4E2D\u8C03\u7528\u4E86\u4F7F\u7528Promise\u5C01\u88C5\u7684\u51FD\u6570\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528async\u6765\u4FEE\u9970\u8BE5\u5173\u952E\u8BCD</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">aaa</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//\u8C03\u7528Promise\u5C01\u88C5\u7684\u51FD\u6570\u65F6\u4F7F\u7528 await\u8FDB\u884C\u4FEE\u9970</span>
  <span class="token comment">//\u8FD9\u65F6\uFF0C\u4E0D\u7BA1\u662F\u9519\u8BEF\u56DE\u8C03\u4E2D\u7684\u7ED3\u679C\u8FD8\u662F\u6B63\u786E\u56DE\u8C03\u4E2D\u7684\u7ED3\u679C</span>
  <span class="token comment">//\u90FD\u80FD\u4EE5\u8FD4\u56DE\u503C\u7684\u5F62\u5F0F\u629B\u51FA\uFF08return\uFF09\uFF0C\u6240\u4EE5\u5C31\u80FD\u4F7F\u7528\u53D8\u91CF\u6765\u63A5\u6536</span>
  <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token string">&#39;./a.txt&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token string">&#39;./b.txt&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token string">&#39;./c.txt&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> m <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">&#39;select * from ali_cate&#39;</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">aaa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>\u6848\u4F8B 2</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bbb</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>

  <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token string">&#39;./c.txt&#39;</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">bbb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div>`,277);function i(k,b){return r}var g=s(u,[["render",i]]);export{g as default};
